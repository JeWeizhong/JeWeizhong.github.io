<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>python3 cookbook笔记：第一章 数据结构和算法(二)---字典的用法 | 木叶村 | life is short</title>

  
  <meta name="author" content="Naruto">
  

  
  <meta name="description" content="无人为孤岛，一书一世界">
  

  
  
  <meta name="keywords" content="编程语言,python3">
  

  <meta id="viewport" name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">

  <meta property="og:title" content="python3 cookbook笔记：第一章 数据结构和算法(二)---字典的用法"/>

  <meta property="og:site_name" content="木叶村"/>

  
  <meta property="og:image" content="/favicon.ico"/>
  

  <link href="/favicon.ico" rel="icon">
  <link rel="alternate" href="/atom.xml" title="木叶村" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
<link rel="stylesheet" href="/css/prism.css" type="text/css"></head>


<body>
<div class="blog">
  <div class="content">

    <header>
  <div class="site-branding">
    <h1 class="site-title">
      <a href="/">木叶村</a>
    </h1>
    <p class="site-description">life is short</p>
  </div>
  <nav class="site-navigation">
    <ul>
      
        <li><a href="/">主页</a></li>
      
        <li><a href="/archives">归档</a></li>
      
    </ul>
  </nav>
</header>

    <main class="site-main posts-loop">
    <article>

  
    
    <h3 class="article-title"><span>python3 cookbook笔记：第一章 数据结构和算法(二)---字典的用法</span></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2018/10/31/python3cook-xi-lie-bi-ji-er/" rel="bookmark">
        <time class="entry-date published" datetime="2018-10-30T16:00:00.000Z">
          2018-10-31
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <p><strong>写在开头：感谢译者们的对本书的翻译！非常棒的一本提升python技能的书，项目地址：<a href="https://github.com/yidao620c/python3-cookbook" target="_blank" rel="noopener">https://github.com/yidao620c/python3-cookbook</a></strong> </p>
<ol>
<li><p><code>collections</code> 模块中的<code>defaultdict</code>函数能够构造一个值为列表的字典：</p>
<pre class=" language-lang-python"><code class="language-lang-python"> from collections import defaultdict
 d = defaultdict(list)
 d['a'].append(1)
 d['a'].append(2)
 d['b'].append(4)
 d = defaultdict(set)
 d['a'].add(1)
 d['a'].add(2)
 d['b'].add(4)
</code></pre>
<p> 简化版：</p>
<pre class=" language-lang-python"><code class="language-lang-python"> d = defaultdict(list)
 for key, value in pairs:
 d[key].append(value)
</code></pre>
</li>
<li><p>字段的键存储是无序的，如果想要一个键顺序是一定的字典，可以这样做：</p>
<pre><code> from collections import OrderedDict
 d = OrderedDict()
</code></pre><p> 但这样做内存占用比较大</p>
</li>
<li><p>如果你在一个字典上执行普通的数学运算，你会发现它们仅仅作用于键，而不是值：</p>
<pre class=" language-lang-python"><code class="language-lang-python"> prices = {
 'ACME': 45.23,
 'AAPL': 612.78,
 'IBM': 205.55,
 'HPQ': 37.20,
 'FB': 10.75
 }
 min(prices) # Returns 'AAPL'
 max(prices) # Returns 'IBM'
</code></pre>
<p> 想要对值进行操作，可以这样：</p>
<pre><code> min(prices, key=lambda k: prices[k]) # Returns &#39;FB&#39;
 max(prices, key=lambda k: prices[k]) # Returns &#39;AAPL&#39;
</code></pre></li>
<li><p>对两个字典进行运算：</p>
<pre class=" language-lang-python"><code class="language-lang-python"> # Find keys in common
 a.keys() & b.keys() # { 'x', 'y' }
 # Find keys in a that are not in b
 a.keys() - b.keys() # { 'z' }
 # Find (key,value) pairs in common
 a.items() & b.items() # { ('y', 2) }
</code></pre>
<p> <del>ps：如果想要对列表消除重复元素可以转换位集合：</del></p>
<pre class=" language-lang-python"><code class="language-lang-python"> >>> a
 [1, 5, 2, 1, 9, 1, 5, 10]
 >>> set(a)
 {1, 2, 10, 5, 9}
 >>>
</code></pre>
<p> 如果想要对一个复杂类型的列表去重复，就要用到一个稍微复杂一点的函数：</p>
<pre class=" language-lang-python"><code class="language-lang-python"> def dedupe(items, key=None):
     seen = set()
     for item in items:
         val = item if key is None else key(item)
         if val not in seen:
             yield item
             seen.add(val)

 >>> a = [ {'x':1, 'y':2}, {'x':1, 'y':3}, {'x':1, 'y':2}, {'x':2, 'y':4}]
 >>> list(dedupe(a, key=lambda d: (d['x'],d['y'])))
 [{'x': 1, 'y': 2}, {'x': 1, 'y': 3}, {'x': 2, 'y': 4}]
 >>> list(dedupe(a, key=lambda d: d['x']))
 [{'x': 1, 'y': 2}, {'x': 2, 'y': 4}]
 >>>
</code></pre>
</li>
<li><p>按照关键字对字典进行排序：</p>
<pre class=" language-lang-python"><code class="language-lang-python"> rows = [
 {'fname': 'Brian', 'lname': 'Jones', 'uid': 1003},
 {'fname': 'David', 'lname': 'Beazley', 'uid': 1002},
 {'fname': 'John', 'lname': 'Cleese', 'uid': 1001},
 {'fname': 'Big', 'lname': 'Jones', 'uid': 1004}
 ]

 from operator import itemgetter
 rows_by_fname = sorted(rows, key=itemgetter('fname'))
 rows_by_uid = sorted(rows, key=itemgetter('uid'))
 print(rows_by_fname)
 print(rows_by_uid)
</code></pre>
</li>
</ol>
<p><code>itemgetter()</code> 有时候也可以用<code>lambda</code> 表达式代替，比如：</p>
<pre><code>```python

rows_by_fname = sorted(rows, key=lambda r: r[&#39;fname&#39;])
rows_by_lfname = sorted(rows, key=lambda r: (r[&#39;lname&#39;],r[&#39;fname&#39;]))
```
</code></pre><p>理论上讲，<code>operator.attrgetter()</code>与 <code>itemgetter()</code> 函数的作用是一样，书中说<strong>排序不支持原生比较的对象</strong>要用<code>attrgetter()</code>函数，反正我也不知道什么是<strong>不支持原生比较的对象</strong></p>
<p><strong>下一节：字典的用法(续)</strong></p>

      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    
      

    <span class="post-categories">
      <i class="icon-categories"></i>
        <a href="/categories/python3/">python3</a>
    </span>
    

    
    

    <span class="post-tags">
      <i class="icon-tags"></i>
        <a href="/tags/编程语言/">编程语言</a><a href="/tags/python3/">python3</a>
    </span>
    

    </div>

    
  </div>
</article>


    </main>

    <footer class="site-footer">
  <p class="site-info">
    Proudly powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and
    Theme by <a href="https://github.com/CodeDaraW/Hacker" target="_blank">Hacker</a>
    </br>
    
    &copy; 2019 Naruto
    
  </p>
</footer>
    
  </div>
</div>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<!--<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>-->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>
</body>
</html>
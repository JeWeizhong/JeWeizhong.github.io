<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.2" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.2" />






<meta property="og:type" content="website">
<meta property="og:title" content="木叶村">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="木叶村">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="木叶村">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/"/>





  <title>木叶村</title>
  














</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">木叶村</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/01/27/算法与数据结构系列(一)---链表/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Naruto">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/137356299.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="木叶村">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/01/27/算法与数据结构系列(一)---链表/" itemprop="url">算法与数据结构系列(一)： 链表</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-01-27T00:00:00+08:00">
                2019-01-27
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/算法与数据结构/" itemprop="url" rel="index">
                    <span itemprop="name">算法与数据结构</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">名称：链表基本操作</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">版本：python3.6</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">日期：20190127</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ListNode</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="string">'''</span></span><br><span class="line"><span class="string">    链表结构，节点类</span></span><br><span class="line"><span class="string">    单链表结构都有两个属性，一个存储自身的值，另一个指针指向下一个值</span></span><br><span class="line"><span class="string">    '''</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,value)</span>:</span></span><br><span class="line">        self.value = value</span><br><span class="line">        self.next = <span class="keyword">None</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UNorderList</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="string">'''</span></span><br><span class="line"><span class="string">    创建一个无序链表,需要实现的操作有：</span></span><br><span class="line"><span class="string">    add(item) ,remove(item),search(item),isEmpty(),size（）,append(item)</span></span><br><span class="line"><span class="string">    index(item),insert(pos，item) ,pop() ,pop(pos) </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    '''</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">'''</span></span><br><span class="line"><span class="string">        创建一个空链表</span></span><br><span class="line"><span class="string">        '''</span></span><br><span class="line">        self.head = <span class="keyword">None</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">isEmpty</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">'''</span></span><br><span class="line"><span class="string">        检查列表是否为空。它不需要参数，并返回布尔值。</span></span><br><span class="line"><span class="string">        '''</span></span><br><span class="line">        <span class="keyword">return</span> self.head == <span class="keyword">None</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(self,item)</span>:</span></span><br><span class="line">        <span class="string">'''</span></span><br><span class="line"><span class="string">        向列表头部添加一个新项。它需要 item 作为参数，并不返回任何内容。假定该 item 不在列表中。</span></span><br><span class="line"><span class="string">        '''</span></span><br><span class="line">        temp = ListNode(item) <span class="comment"># 创建节点</span></span><br><span class="line">        temp.next = self.head</span><br><span class="line">        self.head = temp</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">append</span><span class="params">(self,item)</span>:</span></span><br><span class="line">        <span class="string">'''</span></span><br><span class="line"><span class="string">        将一个新项添加到列表的末尾，使其成为集合中的最后一项。</span></span><br><span class="line"><span class="string">        它需要 item 作为参数，并不返回任何内容。假定该项不在列表中。</span></span><br><span class="line"><span class="string">        '''</span></span><br><span class="line">        cur = self.head</span><br><span class="line">        item = ListNode(item)</span><br><span class="line">        <span class="keyword">if</span> self.head <span class="keyword">is</span> <span class="keyword">None</span>:</span><br><span class="line">            self.head = item</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">while</span> cur.next != <span class="keyword">None</span>:</span><br><span class="line">                cur = cur.next</span><br><span class="line">            cur.next = item</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">size</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">'''</span></span><br><span class="line"><span class="string">        返回列表中的项数。它不需要参数，并返回一个整数。</span></span><br><span class="line"><span class="string">        '''</span></span><br><span class="line">        cur = self.head</span><br><span class="line">        count = <span class="number">0</span></span><br><span class="line">        <span class="keyword">if</span> cur == <span class="keyword">None</span>:</span><br><span class="line">            <span class="keyword">return</span> count</span><br><span class="line">        <span class="keyword">while</span> cur.next != <span class="keyword">None</span>:</span><br><span class="line">            count += <span class="number">1</span></span><br><span class="line">            cur = cur.next</span><br><span class="line">        <span class="keyword">return</span> count+<span class="number">1</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">search</span><span class="params">(self,item)</span>:</span></span><br><span class="line">        <span class="string">'''</span></span><br><span class="line"><span class="string">         搜索列表中的项目。它需要 item 作为参数，并返回一个布尔值。</span></span><br><span class="line"><span class="string">        '''</span></span><br><span class="line">        cur = self.head</span><br><span class="line">        <span class="keyword">while</span> cur.next != <span class="keyword">None</span>:</span><br><span class="line">            <span class="keyword">if</span> item == cur.value:</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">True</span></span><br><span class="line">            cur = cur.next</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">False</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">remove</span><span class="params">(self,item)</span>:</span></span><br><span class="line">        cur = self.head</span><br><span class="line">        prev = <span class="keyword">None</span></span><br><span class="line">        <span class="keyword">while</span> cur.next != <span class="keyword">None</span>:</span><br><span class="line">            <span class="keyword">if</span> item == cur.value:</span><br><span class="line">                <span class="keyword">if</span> prev == <span class="keyword">None</span>:</span><br><span class="line">                    self.head = self.head.next</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    prev.next = cur.next</span><br><span class="line">                    self.head = prev</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">True</span></span><br><span class="line">            prev = cur</span><br><span class="line">            cur = cur.next</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">False</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">index</span><span class="params">(self,item)</span>:</span></span><br><span class="line">        <span class="string">'''</span></span><br><span class="line"><span class="string">        返回项在列表中的位置。它需要 item 作为参数并返回索引。假定该项在列表中。</span></span><br><span class="line"><span class="string">        '''</span></span><br><span class="line">        count = <span class="number">0</span></span><br><span class="line">        cur = self.head</span><br><span class="line">        <span class="keyword">while</span> cur.next != <span class="keyword">None</span>:</span><br><span class="line">            <span class="keyword">if</span> cur.value == item:</span><br><span class="line">                <span class="keyword">return</span> count</span><br><span class="line">            count += <span class="number">1</span></span><br><span class="line">            cur = cur.next</span><br><span class="line">        <span class="keyword">return</span> count</span><br><span class="line">                </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">insert</span><span class="params">(self,pos,item)</span>:</span></span><br><span class="line">        <span class="string">'''</span></span><br><span class="line"><span class="string">        在位置 pos 处向列表中添加一个新项。它需要 item 作为参数并不返回任何内容。</span></span><br><span class="line"><span class="string">        假设该项不在列表中，并且有足够的现有项使其有 pos 的位置。</span></span><br><span class="line"><span class="string">        '''</span></span><br><span class="line">        cur = self.head</span><br><span class="line">        count = <span class="number">1</span></span><br><span class="line">        prev = <span class="keyword">None</span></span><br><span class="line">        item = ListNode(item)</span><br><span class="line">        <span class="keyword">while</span> cur.next != <span class="keyword">None</span>:</span><br><span class="line">            <span class="keyword">if</span> count == pos:</span><br><span class="line">                <span class="keyword">if</span> prev == <span class="keyword">None</span>:</span><br><span class="line">                    item.next = cur</span><br><span class="line">                    self.head = item</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    prev.next = item</span><br><span class="line">                    item.next = cur</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">True</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                count += <span class="number">1</span></span><br><span class="line">                prev = cur</span><br><span class="line">                cur = cur.next</span><br><span class="line">            </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">pop</span><span class="params">(self,pos=None)</span>:</span></span><br><span class="line">        <span class="string">'''</span></span><br><span class="line"><span class="string">        删除并返回列表中的最后一个项。假设该列表至少有一个项。</span></span><br><span class="line"><span class="string">        删除并返回位置 pos 处的项。它需要 pos 作为参数并返回项。假定该项在列表中。</span></span><br><span class="line"><span class="string">        '''</span></span><br><span class="line">        cur = self.head</span><br><span class="line">        prev = <span class="keyword">None</span></span><br><span class="line">        count = <span class="number">1</span></span><br><span class="line">        <span class="keyword">while</span> cur.next != <span class="keyword">None</span>:</span><br><span class="line">            <span class="keyword">if</span> count == pos:</span><br><span class="line">                <span class="keyword">if</span> prev == <span class="keyword">None</span>:</span><br><span class="line">                    prev = cur</span><br><span class="line">                    cur = cur.next</span><br><span class="line">                    self.head = cur</span><br><span class="line">                    <span class="keyword">return</span> prev.value</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    prev.next = cur.next</span><br><span class="line">                    <span class="keyword">return</span> cur.value</span><br><span class="line">            <span class="keyword">else</span>: </span><br><span class="line">                prev = cur</span><br><span class="line">                cur = cur.next</span><br><span class="line">                count += <span class="number">1</span> </span><br><span class="line"></span><br><span class="line">        prev.next = <span class="keyword">None</span></span><br><span class="line">        <span class="keyword">return</span> cur.value</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    test_list = UNorderList()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">5</span>):</span><br><span class="line">        test_list.append(i)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/01/23/机器学习笔记-----Logistic回归/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Naruto">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/137356299.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="木叶村">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/01/23/机器学习笔记-----Logistic回归/" itemprop="url">机器学习笔记-----Logistic回归</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-01-23T00:00:00+08:00">
                2019-01-23
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/机器学习/" itemprop="url" rel="index">
                    <span itemprop="name">机器学习</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Logistic回归,有翻译为“逻辑回归”，但是它跟“逻辑”这个单词一点关系都没有，也不是解决回归问题的，是用来解决二分类的算法，最准确的翻译应该是“对数几率回归”</p>
<p>至于为什么叫对数几率刚回归，请看下面的推倒过程</p>
<h2 id="线性回归回顾"><a href="#线性回归回顾" class="headerlink" title="线性回归回顾"></a>线性回归回顾</h2><p>先来看一个简单的线性回归模型：</p>
<script type="math/tex; mode=display">f(x) = \vec\omega^T \vec{x}+b</script><p>这里的</p>
<script type="math/tex; mode=display">\vec\omega^T = [\omega_1,\omega_2,\cdots,\omega_n]</script><script type="math/tex; mode=display">\vec x  = \left[
\begin{matrix}
x_1 \\
x_2  \\
\cdots\\
x_n  
\end{matrix} \right]</script><p>一般来说给定的数据集是：$D=\{(\vec x^{(1)},y^{(1)}),(\vec x^{(2)},y^{(2)}),⋯,(\vec x^{(m)},y^{(m)})\}$, 即有m组数据，n个未知数，因此多变量线性回归的公式是：</p>
<script type="math/tex; mode=display">f(x)= X^T \vec\omega</script><p>其中：</p>
<script type="math/tex; mode=display">X = \left[
\begin{matrix}
x_1^{(1)} \   x_2^{(1)} \ x_1^{(1)} \ \cdots \ x_n^{(1)} \ 1 \\
x_1^{(2)} \   x_2^{(2)} \ x_3^{(2)} \ \cdots \ x_n^{(2)} \ 1 \\
x_1^{(3)} \   x_2^{(3)} \ x_3^{(3)} \ \cdots \ x_n^{(3)} \ 1 \\
\cdots \\
x_1^{(m)} \   x_2^{(m)} \ x_3^{(m)} \ \cdots \ x_n^{(m)} \ 1 
\end{matrix} \right] =  \left[
\begin{matrix}
\vec x^{(1)T} \ 1 \\
\vec x^{(2)T} \ 1 \\
\vec x^{(3)T} \ 1 \\
\cdots \\
\vec x^{(m)T} \ 1 \\
\end{matrix} \right]</script><p>展开式：</p>
<script type="math/tex; mode=display">\omega_1 x_1^{(1)} + \omega_2 x_2^{(1)} + \cdots + \omega_n x_n^{(1)} +b = y^{(1)}</script><script type="math/tex; mode=display">\omega_1 x_1^{(2)} + \omega_2 x_2^{(2)} + \cdots + \omega_n x_n^{(2)} + b = y^{(2)}</script><script type="math/tex; mode=display">\cdots</script><script type="math/tex; mode=display">\omega_1 x_1^{(m)} + \omega_2 x_2^{(m)} + \cdots + \omega_n x_n^{(m)} +b = y^{(m)}</script><p>我们为了便于推导，忽略了下标，只用了一组$(\vec{x},y)$,然后把$b$当做$\omega_0$，而此时$x_0 = 1$：</p>
<script type="math/tex; mode=display">f(x)=\vec\omega^T \vec{x}</script><h2 id="sigmoid函数"><a href="#sigmoid函数" class="headerlink" title="sigmoid函数"></a>sigmoid函数</h2><p>线性回归很显然是一个连续的值，既然要解决二分类的问题，那最好是换成一个$0/1$的值</p>
<p>这里引出一个sigmoid函数：</p>
<script type="math/tex; mode=display">g(z) = \frac {1}{1+e^{-z}}</script><p><img src="/myphoto/logtic.png" alt="logtic"></p>
<p>令：</p>
<script type="math/tex; mode=display">z =\vec\omega^T \vec{x}+b</script><script type="math/tex; mode=display">f(x) = g(z) = \frac {1}{1+e^{-\vec\omega^T \vec{x}}}</script><p>我们就引出了我们的模型：</p>
<script type="math/tex; mode=display">ln \frac{y}{1-y} =  \vec\omega^T \vec{x}+b</script><p>上式中$\frac{y}{1-y}$ 称为几率，反应x获得正例(y)的相对可能性，由此可以看出，模型实际上是在用线性回归模型的预测结果去逼近真实值$y$的对数几率，因此该模型就称为<strong>对数几率回归模型</strong></p>
<h2 id="代价函数"><a href="#代价函数" class="headerlink" title="代价函数"></a>代价函数</h2><p>由于$y$的值为0,1，我们将$y$视为后验概率：</p>
<script type="math/tex; mode=display">p(y=1 |  x;\omega) = f(x)</script><script type="math/tex; mode=display">p(y=0 |  x;\omega) = 1- f(x)</script><p>$f(x)$越大，代表着预测值与$y$越接近，误差就越小，带入到公式中：</p>
<script type="math/tex; mode=display">p(y=1 |  x;\omega) = \frac {e^{\vec\omega^T \vec{x}}}{1+e^{\vec\omega^T \vec{x}}}</script><script type="math/tex; mode=display">p(y=0 |  x;\omega) = \frac {1}{1+e^{\vec\omega^T \vec{x}}}</script><p>为了确定$\omega$用对数似然函数：</p>
<script type="math/tex; mode=display">\ell(\omega) = lnp(y|x ;\omega)</script><p>可以合并到一起：</p>
<script type="math/tex; mode=display">p(y|x ;\omega) = f(x)^y(1-f(x))^{(1-y)}</script><p>带入到对数似然函数中：</p>
<script type="math/tex; mode=display">ln p(y|x ;\omega) = y lnf(x) + (1-y)ln(1-f(x))</script><p>我们得到的代价函数：</p>
<script type="math/tex; mode=display">J(\omega) = - \frac{1}{m} \sum_{i=1}^m [ y^{(i)} lnf(x^{(i)}) + (1-y^{(i)})ln(1-f(x^{(i)})) ]</script><p>$J(\omega)$越小，就说明$f(x) = 1$的概率越大，因此只要求出$J(\omega)$的<strong>最小值</strong></p>
<blockquote>
<p>ps：</p>
<p>1）其实正常推倒出来的J(w)是没有前面的负号的，这里为了习惯，用梯度下降法求最小值，所以加了一个负号</p>
<p>2） 之前推倒时候忽略了上标，但是我们在最后的损失函数中为了完整性就把上标加了上去</p>
</blockquote>
<h2 id="梯度下降法"><a href="#梯度下降法" class="headerlink" title="梯度下降法"></a>梯度下降法</h2><p>对代价函数求导的过程就不写了，直接写最后的结果:</p>
<script type="math/tex; mode=display">\frac{\partial J(\omega)}{\partial\omega_j} =\frac{1}{m} \sum_{i=1}^m (f(x^{(i)}) - y^{(i)})x_j^{(i)}</script><script type="math/tex; mode=display">\omega_{j+1} := \omega_j- \frac{1}{m}\alpha\sum_{i=1}^m(f(x^{(i)}) - y^{(i)})x_j^{(i)}</script><h2 id="sklearn代码实现逻辑回归"><a href="#sklearn代码实现逻辑回归" class="headerlink" title="sklearn代码实现逻辑回归"></a>sklearn代码实现逻辑回归</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">%matplotlib inline</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dataset = pd.read_csv(<span class="string">r'E:\Downloads\100-Days-Of-ML-Code-master\Social_Network_Ads.csv'</span>)</span><br><span class="line">dataset.head(<span class="number">5</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">X = dataset.iloc[:,[<span class="number">2</span>,<span class="number">3</span>]].values</span><br><span class="line">Y = dataset.iloc[:,<span class="number">4</span>].values</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line">X_train, X_test, y_train, y_test = train_test_split(X, Y, test_size = <span class="number">0.25</span>, random_state = <span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> StandardScaler</span><br><span class="line">sc = StandardScaler()</span><br><span class="line">X_train = sc.fit_transform(X_train)</span><br><span class="line">X_test = sc.transform(X_test)</span><br><span class="line">```    </span><br><span class="line"></span><br><span class="line">```python</span><br><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LogisticRegression</span><br><span class="line">classifier = LogisticRegression()</span><br><span class="line">classifier.fit(X_train, y_train)</span><br><span class="line"><span class="comment"># classifier.coef_</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">y_pred = classifier.predict(X_test)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> confusion_matrix</span><br><span class="line">cm = confusion_matrix(y_test, y_pred)</span><br></pre></td></tr></table></figure>
<p>可视化</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> matplotlib.colors <span class="keyword">import</span> ListedColormap</span><br><span class="line">X_set,y_set=X_train,y_train</span><br><span class="line">X1,X2=np. meshgrid(np. arange(start=X_set[:,<span class="number">0</span>].min()<span class="number">-1</span>, stop=X_set[:, <span class="number">0</span>].max()+<span class="number">1</span>, step=<span class="number">0.01</span>),</span><br><span class="line">                   np. arange(start=X_set[:,<span class="number">1</span>].min()<span class="number">-1</span>, stop=X_set[:,<span class="number">1</span>].max()+<span class="number">1</span>, step=<span class="number">0.01</span>))</span><br><span class="line">plt.contourf(X1, X2, classifier.predict(np.array([X1.ravel(),X2.ravel()]).T).reshape(X1.shape),</span><br><span class="line">             alpha = <span class="number">0.75</span>, cmap = ListedColormap((<span class="string">'red'</span>, <span class="string">'green'</span>)))</span><br><span class="line">plt.xlim(X1.min(),X1.max())</span><br><span class="line">plt.ylim(X2.min(),X2.max())</span><br><span class="line"><span class="keyword">for</span> i,j <span class="keyword">in</span> enumerate(np. unique(y_set)):</span><br><span class="line">    plt.scatter(X_set[y_set==j,<span class="number">0</span>],X_set[y_set==j,<span class="number">1</span>],</span><br><span class="line">                c = ListedColormap((<span class="string">'red'</span>, <span class="string">'green'</span>))(i), label=j)</span><br><span class="line"></span><br><span class="line">plt. title(<span class="string">' LOGISTIC(Training set)'</span>)</span><br><span class="line">plt. xlabel(<span class="string">' Age'</span>)</span><br><span class="line">plt. ylabel(<span class="string">' Estimated Salary'</span>)</span><br><span class="line">plt. legend()</span><br><span class="line">plt. show()</span><br><span class="line"></span><br><span class="line">X_set,y_set=X_test,y_test</span><br><span class="line">X1,X2=np. meshgrid(np. arange(start=X_set[:,<span class="number">0</span>].min()<span class="number">-1</span>, stop=X_set[:, <span class="number">0</span>].max()+<span class="number">1</span>, step=<span class="number">0.01</span>),</span><br><span class="line">                   np. arange(start=X_set[:,<span class="number">1</span>].min()<span class="number">-1</span>, stop=X_set[:,<span class="number">1</span>].max()+<span class="number">1</span>, step=<span class="number">0.01</span>))</span><br><span class="line"></span><br><span class="line">plt.contourf(X1, X2, classifier.predict(np.array([X1.ravel(),X2.ravel()]).T).reshape(X1.shape),</span><br><span class="line">             alpha = <span class="number">0.75</span>, cmap = ListedColormap((<span class="string">'red'</span>, <span class="string">'green'</span>)))</span><br><span class="line">plt.xlim(X1.min(),X1.max())</span><br><span class="line">plt.ylim(X2.min(),X2.max())</span><br><span class="line"><span class="keyword">for</span> i,j <span class="keyword">in</span> enumerate(np. unique(y_set)):</span><br><span class="line">    plt.scatter(X_set[y_set==j,<span class="number">0</span>],X_set[y_set==j,<span class="number">1</span>],</span><br><span class="line">                c = ListedColormap((<span class="string">'red'</span>, <span class="string">'green'</span>))(i), label=j)</span><br><span class="line"></span><br><span class="line">plt. title(<span class="string">' LOGISTIC(Test set)'</span>)</span><br><span class="line">plt. xlabel(<span class="string">' Age'</span>)</span><br><span class="line">plt. ylabel(<span class="string">' Estimated Salary'</span>)</span><br><span class="line">plt. legend()</span><br><span class="line">plt. show()</span><br></pre></td></tr></table></figure>
<p><img src="/myphoto/output_12_0.png" alt="png"></p>
<p><img src="/myphoto/output_12_1.png" alt="png"></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/01/14/机器学习笔记-----线性回归/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Naruto">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/137356299.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="木叶村">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/01/14/机器学习笔记-----线性回归/" itemprop="url">机器学习笔记-----线性回归</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-01-14T00:00:00+08:00">
                2019-01-14
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/机器学习/" itemprop="url" rel="index">
                    <span itemprop="name">机器学习</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="线性模型的基本形式"><a href="#线性模型的基本形式" class="headerlink" title="线性模型的基本形式"></a>线性模型的基本形式</h2><p>给定由d 个属性描述的示例$\vec x = (x_1,x_2,…x_d)$ ， 其中$x_i$是x 在第i个属性上的取值，线性模型(linear model)试图学得一个通过属性的线性组合来进行预测的函数，即:</p>
<script type="math/tex; mode=display">f(\vec x) = \omega_1 x_1 + \omega_2 x_2 +\cdots + \omega_d x_d+d + b  \tag{1}</script><p>写成向量式：</p>
<script type="math/tex; mode=display">f(\vec x ) = \vec\omega^T \vec x  +b \tag{2}</script><h2 id="线性回归原理"><a href="#线性回归原理" class="headerlink" title="线性回归原理"></a>线性回归原理</h2><p>给定数据集$D = \{(\vec x_1 ,y_1),(\vec x_2,y_2),\cdots,(\vec x_m,y_m)\}$,线性回归就是使用$\vec x$得到一个线性模型是的输出$y’$ 无限接近与$y$，即：</p>
<script type="math/tex; mode=display">f(\vec x ) = \vec\omega^T \vec x + b \simeq y \tag{3}</script><p>这里忽略了下标，即每一个输入$\vec x$ 通过线性回归模型的式子$(3)$得到的$y’$ 都无限接近与数据集中的$y$</p>
<h2 id="代价函数"><a href="#代价函数" class="headerlink" title="代价函数"></a>代价函数</h2><p>那么如何确定公式$(3)$中的$\vec\omega$和$b$呢?</p>
<p>如果我们的$f(x)$ 与$y$的差别足够小，那么我们就可以带入到公式$(3)$中直接解出$\vec\omega$和$b$来:</p>
<script type="math/tex; mode=display">min\sum|f(x)-y|</script><p>而在实际运用过程中我们一般用平方误差来做性能度量：</p>
<script type="math/tex; mode=display">min \sum(f(x)-y)^2 \tag{4}</script><p>当然也有其他的性能度量方式，只是平方误差这个在线性回归中最常用，这个求解线性回归参数的方法也叫做<strong>最小二乘法</strong></p>
<p>令：</p>
<script type="math/tex; mode=display">E(w,b) = \sum(f(x)-y)^2 \tag{5}</script><p>$E(w,b)$在这里就叫做<strong>代价函数</strong>,吴恩达老师的机器学习课程中稍做了调整：</p>
<script type="math/tex; mode=display">E(w,b) = \frac{1}{2m} \sum_{i=1}^m (f(x)-y)^2 \tag{5}</script><p>我们只需要对$E(w,b)$求偏导就能够求得最小值，这里假设$E(w,b)$是<strong>凸函数</strong>：</p>
<script type="math/tex; mode=display">\frac{\partial E(\omega,b) }{\partial \omega} = 2(\omega \sum_{1=1}^m x_i^2 - \sum_{i=1}^m (y_i-b)x_i)</script><script type="math/tex; mode=display">\frac{\partial E(\omega,b) }{\partial b} = 2(mb - \sum_{i=1}^m (y_i-\omega x_i))</script><h2 id="梯度下降法"><a href="#梯度下降法" class="headerlink" title="梯度下降法"></a>梯度下降法</h2><p>在讲梯度下降法之前，我们先讲如何直接解出$E(\omega,b)$的最小值：</p>
<p><img src="/myphoto/ml1.png" alt="解方程"></p>
<p><img src="/myphoto/ml2.png" alt="解方程2"></p>
<p><img src="/myphoto/ml3.png" alt="解方程3"></p>
<p>显然这种方法比较复杂，貌似计算量也很大?</p>
<p>下面讲另一种求解$E$最小值的方式，<strong>梯度下降法</strong></p>
<p>该方法的核心思想是同步更新$\vec\omega,b$中每个值：</p>
<script type="math/tex; mode=display">\omega_i = \omega_i -\alpha \frac{\partial E }{\partial \omega_i} ,(i=1,2,...m)</script><p>$\alpha​$称作<strong>学习率</strong>,它的值太小会增加求解的时间，太大会容易造成过拟合。</p>
<p>该方法像是一种穷举，一步一步的找到最小值。</p>
<p>关于这种方法的实现我们将会在逻辑回归中演示，下面讲一下Scikit-Learn关于线性回归的用法。</p>
<h2 id="LinearRegression"><a href="#LinearRegression" class="headerlink" title="LinearRegression"></a>LinearRegression</h2><p>参考sklearn的官方文档中文版：<a href="http://cwiki.apachecn.org/pages/viewpage.action?pageId=12681716" target="_blank" rel="noopener">http://cwiki.apachecn.org/pages/viewpage.action?pageId=12681716</a></p>
<p><code>linear_model.LinearRegression</code>类的成员函数 <code>fit</code> 以数组X和y为输入，并将线性模型的系数$\omega$存储在其成员变量<code>coef_</code> 中：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> sklearn <span class="keyword">import</span> linear_model</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>reg = linear_model.LinearRegression()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>reg.fit ([[<span class="number">0</span>, <span class="number">0</span>], [<span class="number">1</span>, <span class="number">1</span>], [<span class="number">2</span>, <span class="number">2</span>]], [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>])</span><br><span class="line">LinearRegression(copy_X=<span class="keyword">True</span>, fit_intercept=<span class="keyword">True</span>, n_jobs=<span class="number">1</span>, normalize=<span class="keyword">False</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>reg.coef_</span><br><span class="line">array([ <span class="number">0.5</span>,  <span class="number">0.5</span>])</span><br></pre></td></tr></table></figure>
<blockquote>
<p>然而，最小二乘的系数估计依赖于模型特征项的独立性。当特征项相关并且设计矩阵X 的列近似的线性相关时，设计矩阵便接近于一个奇异矩阵(不是满秩，列数过多，会有多个最优解，需要<strong>正则化</strong>)，因此最小二乘估计对观测点中的随机误差变得高度敏感，产生大的方差。</p>
</blockquote>
<h2 id="造轮子"><a href="#造轮子" class="headerlink" title="造轮子"></a>造轮子</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SimpleLR</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        self._a = <span class="keyword">None</span></span><br><span class="line">        self._b = <span class="keyword">None</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">fit</span><span class="params">(self,x_train,y_train)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> x_train.ndim == <span class="number">1</span> <span class="keyword">and</span> len(x_train) == len(y_train):</span><br><span class="line">            self._a = (np.mean(x_train) * np.mean(y_train) - np.mean(x_train * y_train)) / \</span><br><span class="line">                      ((np.mean(x_train)**<span class="number">2</span>) - np.mean(x_train**<span class="number">2</span>))</span><br><span class="line">            self._b = np.mean(y_train) - self._a * np.mean(x_train)</span><br><span class="line">            print(self._a,self._b)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">predict</span><span class="params">(self,x_test)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> x_test.ndim == <span class="number">1</span> <span class="keyword">and</span> self._a <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">None</span> <span class="keyword">and</span> self._b <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">None</span>:</span><br><span class="line">            <span class="keyword">return</span> self._a * x_test + self._b</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    rng = np.random.RandomState(<span class="number">1</span>)</span><br><span class="line">    x_train = <span class="number">10</span> * rng.rand(<span class="number">50</span>) <span class="comment"># 生成均匀分布的50个数</span></span><br><span class="line">    y_train = <span class="number">2</span> * x_train - <span class="number">5</span> + rng.randn(<span class="number">50</span>) <span class="comment"># randn是标准正太分布</span></span><br><span class="line">    x_test = np.linspace(<span class="number">0</span>, <span class="number">10</span>, <span class="number">1000</span>)</span><br><span class="line">    slr = SimpleLR()</span><br><span class="line">    slr.fit(x_train, y_train)</span><br><span class="line">    y = slr.predict(x_test)</span><br><span class="line">    <span class="comment"># 画图</span></span><br><span class="line">    fig = plt.figure()</span><br><span class="line">    plt.scatter(x_train, y_train)</span><br><span class="line">    plt.plot(x_test,y)</span><br><span class="line">    plt.show()</span><br><span class="line">    fig.savefig(<span class="string">'fig.png'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
<p>输出：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">2.027208810360695 -4.998577085553202</span><br></pre></td></tr></table></figure></p>
<p>可见训练效果还是不错的</p>
<p><img src="/myphoto/liner_reg.png" alt="可视化"></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/12/30/python3cookbook年度终极版(超长整理)/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Naruto">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/137356299.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="木叶村">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/12/30/python3cookbook年度终极版(超长整理)/" itemprop="url">python3 cookbook年度终极版(超长整理)</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-12-30T00:00:00+08:00">
                2018-12-30
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/python3/" itemprop="url" rel="index">
                    <span itemprop="name">python3</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="写在开头"><a href="#写在开头" class="headerlink" title="写在开头"></a>写在开头</h2><p><u>这次是对《python3 cookbook》的最终整理笔记，只是一个简短的对问题的回答，方便以后查阅，但其中的原理和扩展知识说的不是很详细，毕竟篇幅有限，所以还是需要去查资料、看文档。鉴于自己也是刚入门python，对书中的一些问题看的不是很明白，因此就出现了很多带有 “略”、“待补充的”字样，如果以后有机会接触到类似的问题，或者自己突然开窍就明白了其中的一些原理，会继续回来补充的</u></p>
<hr>
<hr>
<h2 id="第一章：数据结构和算法"><a href="#第一章：数据结构和算法" class="headerlink" title="第一章：数据结构和算法"></a>第一章：数据结构和算法</h2><h3 id="1-1-解压序列赋值给多个变量"><a href="#1-1-解压序列赋值给多个变量" class="headerlink" title="1.1 解压序列赋值给多个变量"></a>1.1 解压序列赋值给多个变量</h3><p><strong>Q:现在有一个包含N 个元素的元组或者是序列，怎样将它里面的值解压后同时赋值给N 个变量</strong></p>
<p>A: 元祖, 列表，或者其他可迭代对象都可以进行直接解压，并赋值，用 <code>_</code>,<code>*_</code> 占位并丢弃，</p>
<p>用 <code>*name</code>  可以解压成列表形式</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>data = [ <span class="string">'ACME'</span>, <span class="number">50</span>, <span class="number">91.1</span>, (<span class="number">2012</span>, <span class="number">12</span>, <span class="number">21</span>) ]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>_, shares, price, _ = data</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>shares</span><br><span class="line"><span class="number">50</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>price</span><br><span class="line"><span class="number">91.1</span></span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>
<h3 id="1-2-解压可迭代对象赋值给多个变量"><a href="#1-2-解压可迭代对象赋值给多个变量" class="headerlink" title="1.2 解压可迭代对象赋值给多个变量"></a>1.2 解压可迭代对象赋值给多个变量</h3><p><strong>Q: 如果一个可迭代对象的元素个数超过变量个数时，会抛出一个ValueError 。那么怎样才能从这个可迭代对象中解压出N 个元素出来？</strong></p>
<p>A: 星号表达式可以用来收集那些不确定的变量:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>*trailing, current = [<span class="number">10</span>, <span class="number">8</span>, <span class="number">7</span>, <span class="number">1</span>, <span class="number">9</span>, <span class="number">5</span>, <span class="number">10</span>, <span class="number">3</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>trailing</span><br><span class="line">[<span class="number">10</span>, <span class="number">8</span>, <span class="number">7</span>, <span class="number">1</span>, <span class="number">9</span>, <span class="number">5</span>, <span class="number">10</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>current</span><br><span class="line"><span class="number">3</span></span><br></pre></td></tr></table></figure>
<h3 id="1-3-保留最后N-个元素"><a href="#1-3-保留最后N-个元素" class="headerlink" title="1.3 保留最后N 个元素"></a>1.3 保留最后N 个元素</h3><p><strong>Q: 在迭代操作或者其他操作的时候，怎样只保留最后有限几个元素的历史记录？</strong></p>
<p>A: <code>collections.deque</code>会构造函数会新建一个固定大小的队列。当新的元素加入并<br>且这个队列已满的时候，最老的元素会自动被移除掉。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> collections <span class="keyword">import</span> deque</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>q = deque(maxlen=<span class="number">3</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>q.append(<span class="number">1</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>q.append(<span class="number">2</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>q.append(<span class="number">3</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>q</span><br><span class="line">deque([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], maxlen=<span class="number">3</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>q.append(<span class="number">4</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>q</span><br><span class="line">deque([<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>], maxlen=<span class="number">3</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>q.append(<span class="number">5</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>q</span><br><span class="line">deque([<span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>], maxlen=<span class="number">3</span>)</span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>
<p><em><code>collections.deque</code>构造的队列也支持在队列两头进行插入删除操作</em></p>
<h3 id="1-4-查找最大或最小的N-个元素"><a href="#1-4-查找最大或最小的N-个元素" class="headerlink" title="1.4 查找最大或最小的N 个元素"></a>1.4 查找最大或最小的N 个元素</h3><p><strong>Q: 怎样从一个集合中获得最大或者最小的N 个元素列表？</strong></p>
<p>A: <code>heapq</code> 模块有两个函数：<code>nlargest()</code> 和<code>nsmallest()</code> 可以完美解决这个问题。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> heapq</span><br><span class="line">nums = [<span class="number">1</span>, <span class="number">8</span>, <span class="number">2</span>, <span class="number">23</span>, <span class="number">7</span>, <span class="number">-4</span>, <span class="number">18</span>, <span class="number">23</span>, <span class="number">42</span>, <span class="number">37</span>, <span class="number">2</span>]</span><br><span class="line">print(heapq.nlargest(<span class="number">3</span>, nums)) <span class="comment"># Prints [42, 37, 23]</span></span><br><span class="line">print(heapq.nsmallest(<span class="number">3</span>, nums)) <span class="comment"># Prints [-4, 1, 2]</span></span><br></pre></td></tr></table></figure>
<p>也可以接收关键字参数：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">portfolio = [</span><br><span class="line">    &#123;<span class="string">'name'</span>: <span class="string">'IBM'</span>, <span class="string">'shares'</span>: <span class="number">100</span>, <span class="string">'price'</span>: <span class="number">91.1</span>&#125;,</span><br><span class="line">    &#123;<span class="string">'name'</span>: <span class="string">'AAPL'</span>, <span class="string">'shares'</span>: <span class="number">50</span>, <span class="string">'price'</span>: <span class="number">543.22</span>&#125;,</span><br><span class="line">    &#123;<span class="string">'name'</span>: <span class="string">'FB'</span>, <span class="string">'shares'</span>: <span class="number">200</span>, <span class="string">'price'</span>: <span class="number">21.09</span>&#125;,</span><br><span class="line">    &#123;<span class="string">'name'</span>: <span class="string">'HPQ'</span>, <span class="string">'shares'</span>: <span class="number">35</span>, <span class="string">'price'</span>: <span class="number">31.75</span>&#125;,</span><br><span class="line">    &#123;<span class="string">'name'</span>: <span class="string">'YHOO'</span>, <span class="string">'shares'</span>: <span class="number">45</span>, <span class="string">'price'</span>: <span class="number">16.35</span>&#125;,</span><br><span class="line">    &#123;<span class="string">'name'</span>: <span class="string">'ACME'</span>, <span class="string">'shares'</span>: <span class="number">75</span>, <span class="string">'price'</span>: <span class="number">115.65</span>&#125;</span><br><span class="line">]</span><br><span class="line">cheap = heapq.nsmallest(<span class="number">3</span>, portfolio, key=<span class="keyword">lambda</span> s: s[<span class="string">'price'</span>])</span><br><span class="line">expensive = heapq.nlargest(<span class="number">3</span>, portfolio, key=<span class="keyword">lambda</span> s: s[<span class="string">'price'</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 上面代码在对每个元素进行对比的时候，会以price 的值进行比较</span></span><br></pre></td></tr></table></figure>
<h3 id="1-5-实现一个优先级队列"><a href="#1-5-实现一个优先级队列" class="headerlink" title="1.5 实现一个优先级队列"></a>1.5 实现一个优先级队列</h3><p><strong>Q:怎样实现一个按优先级排序的队列？并且在这个队列上面每次pop 操作总是返回优先级最高的那个元素</strong></p>
<p>A: 利用heapq 模块可是实现一个简单的优先级队列:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> heapq</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PriorityQueue</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        self._queue = []</span><br><span class="line">        self._index = <span class="number">0</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">push</span><span class="params">(self, item, priority)</span>:</span></span><br><span class="line">        heapq.heappush(self._queue, (-priority, self._index, item))</span><br><span class="line">        self._index += <span class="number">1</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">pop</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> heapq.heappop(self._queue)[<span class="number">-1</span>]</span><br></pre></td></tr></table></figure>
<p>使用方式：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="class"><span class="keyword">class</span> <span class="title">Item</span>:</span></span><br><span class="line"><span class="meta">... </span>    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name)</span>:</span></span><br><span class="line"><span class="meta">... </span>        self.name = name</span><br><span class="line"><span class="meta">... </span>    <span class="function"><span class="keyword">def</span> <span class="title">__repr__</span><span class="params">(self)</span>:</span></span><br><span class="line"><span class="meta">... </span>        <span class="keyword">return</span> <span class="string">'Item(&#123;!r&#125;)'</span>.format(self.name)</span><br><span class="line">...</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>q = PriorityQueue()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>q.push(Item(<span class="string">'foo'</span>), <span class="number">1</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>q.push(Item(<span class="string">'bar'</span>), <span class="number">5</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>q.push(Item(<span class="string">'spam'</span>), <span class="number">4</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>q.push(Item(<span class="string">'grok'</span>), <span class="number">1</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>q.pop()</span><br><span class="line">Item(<span class="string">'bar'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>q.pop()</span><br><span class="line">Item(<span class="string">'spam'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>q.pop()</span><br><span class="line">Item(<span class="string">'foo'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>q.pop()</span><br><span class="line">Item(<span class="string">'grok'</span>)</span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>
<h3 id="1-6-字典中的键映射多个值"><a href="#1-6-字典中的键映射多个值" class="headerlink" title="1.6 字典中的键映射多个值"></a>1.6 字典中的键映射多个值</h3><p><strong>Q: 怎样实现一个键对应多个值的字典（也叫multidict）？</strong></p>
<p>A:这其实也就是字典与列表的嵌套，有三种方式实现： 一是自己创建，二是用<code>collections.defaultdict</code>，最后一种是用<code>setdefault</code> : </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">d = &#123;&#125;</span><br><span class="line"><span class="keyword">for</span> key, value <span class="keyword">in</span> pairs:</span><br><span class="line">    <span class="keyword">if</span> key <span class="keyword">not</span> <span class="keyword">in</span> d:</span><br><span class="line">        d[key] = []</span><br><span class="line">    d[key].append(value)</span><br></pre></td></tr></table></figure>
<p><code>defaultdict</code> 会自动为将要访问的键（就算目前字典中并不存在这样的键）创建映射实体:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> defaultdict</span><br><span class="line"></span><br><span class="line">d = defaultdict(list)</span><br><span class="line"><span class="keyword">for</span> key, value <span class="keyword">in</span> pairs:</span><br><span class="line">    d[key].append(value)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">d = &#123;&#125; <span class="comment"># A regular dictionary</span></span><br><span class="line">d.setdefault(<span class="string">'a'</span>, []).append(<span class="number">1</span>)</span><br><span class="line">d.setdefault(<span class="string">'a'</span>, []).append(<span class="number">2</span>)</span><br><span class="line">d.setdefault(<span class="string">'b'</span>, []).append(<span class="number">4</span>)</span><br></pre></td></tr></table></figure>
<h3 id="1-7-字典排序"><a href="#1-7-字典排序" class="headerlink" title="1.7 字典排序"></a>1.7 字典排序</h3><p><strong>Q: 你想创建一个字典，并且在迭代或序列化这个字典的时候能够控制元素的顺序</strong></p>
<p>A: 字典默认是不排序的，所以每次遍历输出的键顺序是不一样的，而<code>collections.OrderedDict</code>会创建一个键顺序固定的字典：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> OrderedDict</span><br><span class="line"></span><br><span class="line">d = OrderedDict()</span><br><span class="line">d[<span class="string">'foo'</span>] = <span class="number">1</span></span><br><span class="line">d[<span class="string">'bar'</span>] = <span class="number">2</span></span><br><span class="line">d[<span class="string">'spam'</span>] = <span class="number">3</span></span><br><span class="line">d[<span class="string">'grok'</span>] = <span class="number">4</span></span><br><span class="line"><span class="comment"># Outputs "foo 1", "bar 2", "spam 3", "grok 4"</span></span><br><span class="line"><span class="keyword">for</span> key <span class="keyword">in</span> d:</span><br><span class="line">    print(key, d[key])`</span><br></pre></td></tr></table></figure>
<h3 id="1-8-字典的运算"><a href="#1-8-字典的运算" class="headerlink" title="1.8 字典的运算"></a>1.8 字典的运算</h3><p><strong>Q: 怎样在数据字典中执行一些计算操作（比如求最小值、最大值、排序等等）？</strong></p>
<p>A: <code>zip()</code>函数可以将字典的键与值反转，然后我们可以愉快的进行排序，求最值等操作了：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>prices = &#123;</span><br><span class="line"><span class="meta">... </span><span class="string">'ACME'</span>: <span class="number">45.23</span>,</span><br><span class="line"><span class="meta">... </span><span class="string">'AAPL'</span>: <span class="number">612.78</span>,</span><br><span class="line"><span class="meta">... </span><span class="string">'IBM'</span>: <span class="number">205.55</span>,</span><br><span class="line"><span class="meta">... </span><span class="string">'HPQ'</span>: <span class="number">37.20</span>,</span><br><span class="line"><span class="meta">... </span><span class="string">'FB'</span>: <span class="number">10.75</span></span><br><span class="line"><span class="meta">... </span>&#125;</span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>zip(prices.values(), prices.keys())</span><br><span class="line">&lt;zip object at <span class="number">0x7fdfae678548</span>&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>min(zip(prices.values(), prices.keys()))</span><br><span class="line">(<span class="number">10.75</span>, <span class="string">'FB'</span>)</span><br></pre></td></tr></table></figure>
<h3 id="1-9-查找两字典的相同点"><a href="#1-9-查找两字典的相同点" class="headerlink" title="1.9 查找两字典的相同点"></a>1.9 查找两字典的相同点</h3><p><strong>Q: 怎样在两个字典中寻找相同点（比如相同的键、相同的值等等）？</strong></p>
<p>A: 其实就是两个列表的运算：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>a = &#123;</span><br><span class="line"><span class="meta">... </span><span class="string">'x'</span> : <span class="number">1</span>,</span><br><span class="line"><span class="meta">... </span><span class="string">'y'</span> : <span class="number">2</span>,</span><br><span class="line"><span class="meta">... </span><span class="string">'z'</span> : <span class="number">3</span></span><br><span class="line"><span class="meta">... </span>&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>b = &#123;</span><br><span class="line"><span class="meta">... </span><span class="string">'w'</span> : <span class="number">10</span>,</span><br><span class="line"><span class="meta">... </span><span class="string">'x'</span> : <span class="number">11</span>,</span><br><span class="line"><span class="meta">... </span><span class="string">'y'</span> : <span class="number">2</span></span><br><span class="line"><span class="meta">... </span>&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a.keys() &amp; b.keys()</span><br><span class="line">&#123;<span class="string">'x'</span>, <span class="string">'y'</span>&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a.keys() - b.keys()</span><br><span class="line">&#123;<span class="string">'z'</span>&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>b.keys() - a.keys()</span><br><span class="line">&#123;<span class="string">'w'</span>&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a.items() &amp; b.items()</span><br><span class="line">&#123;(<span class="string">'y'</span>, <span class="number">2</span>)&#125;</span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>
<h3 id="1-10-删除序列相同元素并保持顺序"><a href="#1-10-删除序列相同元素并保持顺序" class="headerlink" title="1.10 删除序列相同元素并保持顺序"></a>1.10 删除序列相同元素并保持顺序</h3><p><strong>Q: 怎样在一个序列上面保持元素顺序的同时消除重复的值？</strong></p>
<p>A: 大家首先想到的方法是<code>ser()</code>，但是这种方法不能维护元素的顺序，其实方法有很多中，可以构建一个键位固定的字典(<code>OrderedDict</code>),也可对``set()稍作调整：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dedupe</span><span class="params">(items)</span>:</span></span><br><span class="line">    seen = set()</span><br><span class="line">    <span class="keyword">for</span> item <span class="keyword">in</span> items:</span><br><span class="line">        <span class="keyword">if</span> item <span class="keyword">not</span> <span class="keyword">in</span> seen:</span><br><span class="line">        <span class="keyword">yield</span> item</span><br><span class="line">        seen.add(item)</span><br></pre></td></tr></table></figure>
<h3 id="1-11-命名切片"><a href="#1-11-命名切片" class="headerlink" title="1.11 命名切片"></a>1.11 命名切片</h3><p><strong>Q: 你的程序已经出现一大堆已无法直视的硬编码切片下标，然后你想清理下代码。</strong></p>
<p>A: <code>slice()</code>方法可以对切片进行命名，而避免用一大堆难以阅读的下标进行运算：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>items = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a = slice(<span class="number">2</span>, <span class="number">4</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>items[<span class="number">2</span>:<span class="number">4</span>]</span><br><span class="line">[<span class="number">2</span>, <span class="number">3</span>]</span><br></pre></td></tr></table></figure>
<h3 id="1-12-序列中出现次数最多的元素"><a href="#1-12-序列中出现次数最多的元素" class="headerlink" title="1.12 序列中出现次数最多的元素"></a>1.12 序列中出现次数最多的元素</h3><p><strong>Q:怎样找出序列中出现次数最多的元素呢？</strong></p>
<p>A: <code>collecttions.Counter</code>类中的<code>most_common</code>就可以直接给出答案，当然你也可以手动计数：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>a = [<span class="number">1</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">6</span>,<span class="number">6</span>,<span class="number">6</span>,<span class="number">6</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span></span><br><span class="line"><span class="keyword">from</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> collections <span class="keyword">import</span> Counter</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>w = Counter(a)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>w</span><br><span class="line">Counter(&#123;<span class="number">6</span>: <span class="number">4</span>, <span class="number">1</span>: <span class="number">3</span>, <span class="number">2</span>: <span class="number">2</span>&#125;)</span><br><span class="line"><span class="comment"># 出现频率最高的1个数</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>w.most_common(<span class="number">1</span>)</span><br><span class="line">[(<span class="number">6</span>, <span class="number">4</span>)]</span><br><span class="line"><span class="comment"># 出现频率最高的两个数</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>w.most_common(<span class="number">2</span>)</span><br><span class="line">[(<span class="number">6</span>, <span class="number">4</span>), (<span class="number">1</span>, <span class="number">3</span>)]</span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>
<h3 id="1-13-通过某个关键字排序一个字典列表"><a href="#1-13-通过某个关键字排序一个字典列表" class="headerlink" title="1.13 通过某个关键字排序一个字典列表"></a>1.13 通过某个关键字排序一个字典列表</h3><p><strong>Q:你有一个字典列表，你想根据某个或某届字典字段来排序这个列表</strong></p>
<p>A: <code>operator</code> 模块的<code>itemgetter</code> 函数可以生成一个<strong>callable</strong>对象，当作关键字传入到<code>sorted</code>函数中：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">rows = [</span><br><span class="line">&#123;<span class="string">'fname'</span>: <span class="string">'Brian'</span>, <span class="string">'lname'</span>: <span class="string">'Jones'</span>, <span class="string">'uid'</span>: <span class="number">1003</span>&#125;,</span><br><span class="line">&#123;<span class="string">'fname'</span>: <span class="string">'David'</span>, <span class="string">'lname'</span>: <span class="string">'Beazley'</span>, <span class="string">'uid'</span>: <span class="number">1002</span>&#125;,</span><br><span class="line">&#123;<span class="string">'fname'</span>: <span class="string">'John'</span>, <span class="string">'lname'</span>: <span class="string">'Cleese'</span>, <span class="string">'uid'</span>: <span class="number">1001</span>&#125;,</span><br><span class="line">&#123;<span class="string">'fname'</span>: <span class="string">'Big'</span>, <span class="string">'lname'</span>: <span class="string">'Jones'</span>, <span class="string">'uid'</span>: <span class="number">1004</span>&#125;</span><br><span class="line">]</span><br><span class="line"><span class="keyword">from</span> operator <span class="keyword">import</span> itemgetter</span><br><span class="line">rows_by_fname = sorted(rows, key=itemgetter(<span class="string">'fname'</span>))</span><br><span class="line">rows_by_uid = sorted(rows, key=itemgetter(<span class="string">'uid'</span>))</span><br><span class="line">print(rows_by_fname)</span><br><span class="line">print(rows_by_uid)</span><br></pre></td></tr></table></figure>
<h3 id="1-14-排序不支持原生比较的对象"><a href="#1-14-排序不支持原生比较的对象" class="headerlink" title="1.14 排序不支持原生比较的对象"></a>1.14 排序不支持原生比较的对象</h3><p><strong>Q: 你想排序类型相同的对象，但是他们不支持原生的比较操作。</strong></p>
<p>A: 内置的<code>sorted</code>是值可以传入<strong>callable</strong>对象，传入其他的对象就需要用<code>operator.attrgetter()</code> 或者<code>lamba</code>来构造，示例略</p>
<h3 id="1-15-通过某个字段将记录分组"><a href="#1-15-通过某个字段将记录分组" class="headerlink" title="1.15 通过某个字段将记录分组"></a>1.15 通过某个字段将记录分组</h3><p><strong>Q: 个字典或者实例的序列，然后你想根据某个特定的字段比如date 来分组迭代访问。</strong></p>
<p>A: 用<code>itertools.groupby()</code>函数, 使用之前要先排序，示例略</p>
<h3 id="1-16-过滤序列元素"><a href="#1-16-过滤序列元素" class="headerlink" title="1.16 过滤序列元素"></a>1.16 过滤序列元素</h3><p><strong>Q: 个数据序列，想利用一些规则从中提取出需要的值或者是缩短序列</strong></p>
<p>A: 最简单的方法就是列表推倒，也可以直接迭代，这里要说的另外的方法就是<code>filter()</code>函数，它接收一个函数和要过滤的列表，接受的函数可以定义过滤规则，另外一个值得关注的过滤工具就是<code>tertools.compress()</code>, 用法也差不多：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">values = [<span class="string">'1'</span>, <span class="string">'2'</span>, <span class="string">'-3'</span>, <span class="string">'-'</span>, <span class="string">'4'</span>, <span class="string">'N/A'</span>, <span class="string">'5'</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">is_int</span><span class="params">(val)</span>:</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        x = int(val)</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">True</span></span><br><span class="line">    <span class="keyword">except</span> ValueError:</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">False</span></span><br><span class="line">        </span><br><span class="line">ivals = list(filter(is_int, values))</span><br><span class="line">print(ivals)</span><br><span class="line"><span class="comment"># Outputs ['1', '2', '-3', '4', '5']</span></span><br></pre></td></tr></table></figure>
<h3 id="1-17-从字典中提取子集"><a href="#1-17-从字典中提取子集" class="headerlink" title="1.17 从字典中提取子集"></a>1.17 从字典中提取子集</h3><p><strong>Q:构造一个字典，它是另外一个字典的子集。</strong></p>
<p>A: 字典推倒，示例略</p>
<h3 id="1-18-映射名称到序列元素"><a href="#1-18-映射名称到序列元素" class="headerlink" title="1.18 映射名称到序列元素"></a>1.18 映射名称到序列元素</h3><p><strong>Q: 段通过下标访问列表或者元组中元素的代码，但是这样有时候会使得你的代码难以阅读，于是你想通过名称来访问元素。</strong></p>
<p>A:  使用<code>collections.namedtuple()</code>函数来对元组进行命名：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> collections <span class="keyword">import</span> namedtuple</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>Subscriber = namedtuple(<span class="string">'Subscriber'</span>, [<span class="string">'addr'</span>, <span class="string">'joined'</span>])</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>sub = Subscriber(<span class="string">'jonesy@example.com'</span>, <span class="string">'2012-10-19'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>sub</span><br><span class="line">Subscriber(addr=<span class="string">'jonesy@example.com'</span>, joined=<span class="string">'2012-10-19'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>sub.addr</span><br><span class="line"><span class="string">'jonesy@example.com'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>sub.joined</span><br><span class="line"><span class="string">'2012-10-19'</span></span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>
<h3 id="1-19-转换并同时计算数据"><a href="#1-19-转换并同时计算数据" class="headerlink" title="1.19 转换并同时计算数据"></a>1.19 转换并同时计算数据</h3><p><strong>Q: 在数据序列上执行聚集函数（比如sum() , min() , max() ），但是首先你需<br>要先转换或者过滤数据</strong></p>
<p>A: 一般来讲，我们都是先进行过滤再进行计算，但是python为了是语法更简洁，可以允许我们省略中间的临时列表：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">nums = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>]</span><br><span class="line">s = sum((x * x <span class="keyword">for</span> x <span class="keyword">in</span> nums)) <span class="comment"># 显示的传递一个生成器表达式对象</span></span><br><span class="line">s = sum(x * x <span class="keyword">for</span> x <span class="keyword">in</span> nums) <span class="comment"># 更加优雅的实现方式，省略了括号</span></span><br></pre></td></tr></table></figure>
<h3 id="1-20-合并多个字典或映射"><a href="#1-20-合并多个字典或映射" class="headerlink" title="1.20 合并多个字典或映射"></a>1.20 合并多个字典或映射</h3><p><strong>Q: 多个字典或者映射，你想将它们从逻辑上合并为一个单一的映射后执行某些操作，比如查找值或者检查某些键是否存在。</strong></p>
<p>A: <code>llections</code>模块中的<code>CainMap</code>类可以讲两个字典在逻辑上和为一个字典：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">a = &#123;<span class="string">'x'</span>: <span class="number">1</span>, <span class="string">'z'</span>: <span class="number">3</span> &#125;</span><br><span class="line">b = &#123;<span class="string">'y'</span>: <span class="number">2</span>, <span class="string">'z'</span>: <span class="number">4</span> &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> ChainMap</span><br><span class="line"></span><br><span class="line">c = ChainMap(a,b)</span><br><span class="line">print(c[<span class="string">'x'</span>]) <span class="comment"># Outputs 1 (from a)</span></span><br><span class="line">print(c[<span class="string">'y'</span>]) <span class="comment"># Outputs 2 (from b)</span></span><br><span class="line">print(c[<span class="string">'z'</span>]) <span class="comment"># Outputs 3 (from a)  若有重复值那么只输出一个的值</span></span><br></pre></td></tr></table></figure>
<hr>
<hr>
<h2 id="第二章：字符串和文本"><a href="#第二章：字符串和文本" class="headerlink" title="第二章：字符串和文本"></a>第二章：字符串和文本</h2><h3 id="2-1-使用多个界定符分割字符串"><a href="#2-1-使用多个界定符分割字符串" class="headerlink" title="2.1 使用多个界定符分割字符串"></a>2.1 使用多个界定符分割字符串</h3><p><strong>Q: 你需要将一个字符串分割为多个字段，但是分隔符(还有周围的空格) 并不是固定的。</strong></p>
<p>A: 用<code>re.split</code>, 因为<code>str.split</code>并不允许多个分隔符：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>line = <span class="string">'asdf fjdk; afed, fjek,asdf, foo'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> re</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>re.split(<span class="string">r'[;,\s]\s*'</span>, line)</span><br><span class="line">[<span class="string">'asdf'</span>, <span class="string">'fjdk'</span>, <span class="string">'afed'</span>, <span class="string">'fjek'</span>, <span class="string">'asdf'</span>, <span class="string">'foo'</span>]</span><br><span class="line"><span class="comment"># 如果有捕获分组的话，如果捕获到了也会输出</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>fields = re.split(<span class="string">r'(;|,|\s)\s*'</span>, line)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>fields</span><br><span class="line">[<span class="string">'asdf'</span>, <span class="string">' '</span>, <span class="string">'fjdk'</span>, <span class="string">';'</span>, <span class="string">'afed'</span>, <span class="string">','</span>, <span class="string">'fjek'</span>, <span class="string">','</span>, <span class="string">'asdf'</span>, <span class="string">','</span>, <span class="string">'foo'</span>]</span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line"><span class="comment"># 形如(?:....) 就不会输出捕获的分组</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>re.split(<span class="string">r'(?:,|;|\s)\s*'</span>, line)</span><br><span class="line">[<span class="string">'asdf'</span>, <span class="string">'fjdk'</span>, <span class="string">'afed'</span>, <span class="string">'fjek'</span>, <span class="string">'asdf'</span>, <span class="string">'foo'</span>]</span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>
<h3 id="2-2-字符串开头或结尾匹配"><a href="#2-2-字符串开头或结尾匹配" class="headerlink" title="2.2 字符串开头或结尾匹配"></a>2.2 字符串开头或结尾匹配</h3><p><strong>Q: 你需要通过指定的文本模式去检查字符串的开头或者结尾，比如文件名后缀，URLScheme 等等。</strong></p>
<p>A: 参考<code>startswith()</code> 和<code>endswith()</code> 方法,当然也可以用正则表达式或者对字符串进行切片</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>filename = <span class="string">'spam.txt'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>filename.endswith(<span class="string">'.txt'</span>)</span><br><span class="line"><span class="keyword">True</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>filename.startswith(<span class="string">'file:'</span>)</span><br><span class="line"><span class="keyword">False</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>url = <span class="string">'http://www.python.org'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>url.startswith(<span class="string">'http:'</span>)</span><br><span class="line"><span class="keyword">True</span></span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>
<p>也可以接收以元祖作为参数</p>
<h3 id="2-3-用Shell-通配符匹配字符串"><a href="#2-3-用Shell-通配符匹配字符串" class="headerlink" title="2.3 用Shell 通配符匹配字符串"></a>2.3 用Shell 通配符匹配字符串</h3><p><strong>A: 你想使用Unix Shell 中常用的通配符(比如<code>*.py</code> , <code>Dat[0-9]*.csv</code> 等) 去匹配文本字符串</strong></p>
<p>A: 参见<code>fnmatch</code> 模块提供的两个函数——<code>fnmatch()</code> 和<code>fnmatchcase()</code>，示例略</p>
<h3 id="2-4-字符串匹配和搜索"><a href="#2-4-字符串匹配和搜索" class="headerlink" title="2.4 字符串匹配和搜索"></a>2.4 字符串匹配和搜索</h3><p><strong>Q: 你想匹配或者搜索特定模式的文本</strong></p>
<p>A: 正则表达式</p>
<h3 id="2-5-字符串搜索和替换"><a href="#2-5-字符串搜索和替换" class="headerlink" title="2.5 字符串搜索和替换"></a>2.5 字符串搜索和替换</h3><p><strong>Q: 你想在字符串中搜索和匹配指定的文本模式</strong></p>
<p>A: <code>str.replace()</code> ,<code>re.sub()</code>:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>text = <span class="string">'Today is 11/27/2012. PyCon starts 3/13/2013.'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> re</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>re.sub(<span class="string">r'(\d+)/(\d+)/(\d+)'</span>, <span class="string">r'\3-\1-\2'</span>, text)</span><br><span class="line"><span class="string">'Today is 2012-11-27. PyCon starts 2013-3-13.'</span></span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>
<p><code>sub()</code> 函数中的第一个参数是被匹配的模式，第二个参数是替换模式。反斜杠数字比如”\3” 指向前面模式的<strong>捕获组号</strong>。</p>
<h3 id="2-6-字符串忽略大小写的搜索替换"><a href="#2-6-字符串忽略大小写的搜索替换" class="headerlink" title="2.6 字符串忽略大小写的搜索替换"></a>2.6 字符串忽略大小写的搜索替换</h3><p><strong>Q: 你需要以忽略大小写的方式搜索与替换文本字符串</strong></p>
<p>A: 在正则表达式中使用<code>re.IGNORECASE</code>参数</p>
<h3 id="2-7-最短匹配模式"><a href="#2-7-最短匹配模式" class="headerlink" title="2.7 最短匹配模式"></a>2.7 最短匹配模式</h3><p><strong>Q: 你正在试着用正则表达式匹配某个文本模式，但是它找到的是模式的最长可能匹配。而你想修改它变成查找最短的可能匹配。</strong></p>
<p>A: 使用<code>?</code>进行非贪婪匹配：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>text2 = <span class="string">'Computer says "no." Phone says "yes."'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>str_pat.findall(text2)</span><br><span class="line">[<span class="string">'no." Phone says "yes.'</span>]</span><br><span class="line"><span class="comment"># 非贪婪匹配</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>str_pat = re.compile(<span class="string">r'\"(.*?)\"'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>str_pat.findall(text2)</span><br><span class="line">[<span class="string">'no.'</span>, <span class="string">'yes.'</span>]</span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>
<h3 id="2-8-多行匹配模式"><a href="#2-8-多行匹配模式" class="headerlink" title="2.8 多行匹配模式"></a>2.8 多行匹配模式</h3><p><strong>Q: 你正在试着使用正则表达式去匹配一大块的文本，而你需要跨越多行去匹配。</strong></p>
<p>A: 使用<code>re.DOTALL</code>参数：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> re</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a = <span class="string">'''hello</span></span><br><span class="line"><span class="string"><span class="meta">... </span>world'''</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a</span><br><span class="line"><span class="string">'hello\nworld'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>re.search(<span class="string">'(o.*)'</span>,a,re.DOTALL).group(<span class="number">1</span>)</span><br><span class="line"><span class="string">'o\nworld'</span></span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>
<h3 id="2-9-将Unicode-文本标准化"><a href="#2-9-将Unicode-文本标准化" class="headerlink" title="2.9 将Unicode 文本标准化"></a>2.9 将Unicode 文本标准化</h3><p><strong>Q: 你正在处理Unicode 字符串，需要确保所有字符串在底层有相同的表示。</strong></p>
<p>A: 在Unicode 中，某些字符能够用多个合法的编码表示,所以有些字符在编码字节是不同的，但是在显示的时候却是一样的，这种情况可以用<code>unicodedata</code> 模块先将文本标准化</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>s1 = <span class="string">'Spicy Jalape\u00f1o'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s2 = <span class="string">'Spicy Jalapen\u0303o'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s1</span><br><span class="line"><span class="string">'Spicy Jalapeño'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s2</span><br><span class="line"><span class="string">'Spicy Jalapeño'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s1 == s2</span><br><span class="line"><span class="keyword">False</span></span><br><span class="line"><span class="comment">####</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> unicodedata</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>t1 = unicodedata.normalize(<span class="string">'NFC'</span>, s1)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>t2 = unicodedata.normalize(<span class="string">'NFC'</span>, s2)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>t1 == t2</span><br><span class="line"><span class="keyword">True</span></span><br></pre></td></tr></table></figure>
<p>关于<code>unicodedata</code> 模块的其他用法请参考官方文档</p>
<h3 id="2-10-在正则式中使用Unicode"><a href="#2-10-在正则式中使用Unicode" class="headerlink" title="2.10 在正则式中使用Unicode"></a>2.10 在正则式中使用Unicode</h3><p><strong>Q:你正在使用正则表达式处理文本，但是关注的是Unicode 字符处理。</strong></p>
<p>A: <code>re</code>模块支持Unicode 字符，直接用就好：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>pat = re.compile(<span class="string">'stra\u00dfe'</span>, re.IGNORECASE)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s = <span class="string">'straße'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>pat.match(s) <span class="comment"># Matches</span></span><br><span class="line">&lt;_sre.SRE_Match object at <span class="number">0x10069d370</span>&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>pat.match(s.upper()) <span class="comment"># Doesn't match</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s.upper() <span class="comment"># Case folds</span></span><br><span class="line"><span class="string">'STRASSE'</span></span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>
<h3 id="2-11-删除字符串中不需要的字符"><a href="#2-11-删除字符串中不需要的字符" class="headerlink" title="2.11 删除字符串中不需要的字符"></a>2.11 删除字符串中不需要的字符</h3><p><strong>Q: 你想去掉文本字符串开头，结尾或者中间不想要的字符，比如空白</strong></p>
<p>A: <code>strip()</code> 方法能用于删除开始或结尾的字符。<code>lstrip()</code> 和<code>rstrip()</code> 分别从左和从右执行删除操作。默认情况下，这些方法会去除空白字符，但是你也可以指定其他字符。<br>当然也可以使用正则表达式</p>
<h3 id="2-12-审查清理文本字符串"><a href="#2-12-审查清理文本字符串" class="headerlink" title="2.12 审查清理文本字符串"></a>2.12 审查清理文本字符串</h3><p><strong>Q: 一些无聊的幼稚黑客在你的网站页面表单中输入文本”pýtĥöñ”，然后你想将这些字符清理掉。</strong></p>
<p>A: 解决的思路就是用<code>str.upper()</code> 和<code>str.lower()</code>将字符串标准化，使用<code>str.replace()</code> 或者<code>re.sub()</code><br>对字符串进行删除或者替换，问题中的文本 “pýtĥöñ” 则可以用<code>unicodedata.normalize()</code> 函数将unicode文本标准化。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>a</span><br><span class="line"><span class="string">'pýtĥöñ is awesome\n'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>b = unicodedata.normalize(<span class="string">'NFD'</span>, a)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>b.encode(<span class="string">'ascii'</span>, <span class="string">'ignore'</span>).decode(<span class="string">'ascii'</span>)</span><br><span class="line"><span class="string">'python is awesome\n'</span></span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>
<p>另外再介绍一下经常会被忽视的<code>str.translate()</code>方法:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>s = <span class="string">'pýtĥöñ\fis\tawesome\r\n'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s</span><br><span class="line"><span class="string">'pýtĥöñ\x0cis\tawesome\r\n'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>remap = &#123;</span><br><span class="line"><span class="meta">... </span>ord(<span class="string">'\t'</span>) : <span class="string">' '</span>, <span class="comment"># 将特殊字符重新映射为空格</span></span><br><span class="line"><span class="meta">... </span>ord(<span class="string">'\f'</span>) : <span class="string">' '</span>,</span><br><span class="line"><span class="meta">... </span>ord(<span class="string">'\r'</span>) : <span class="keyword">None</span> <span class="comment"># 删除</span></span><br><span class="line"><span class="meta">... </span>&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a = s.translate(remap)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a</span><br><span class="line"><span class="string">'pýtĥöñ is awesome\n'</span></span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>
<h3 id="2-13-字符串对齐"><a href="#2-13-字符串对齐" class="headerlink" title="2.13 字符串对齐"></a>2.13 字符串对齐</h3><p><strong>Q: 你想通过某种对齐方式来格式化字符串</strong></p>
<p>A: 可以使用字符串的<code>ljust()</code> , <code>rjust()</code> 和<code>center()</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>text = <span class="string">'Hello World'</span></span><br><span class="line"><span class="comment"># 默认是空格，也可以接收其他字符</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>text.ljust(<span class="number">20</span>)</span><br><span class="line"><span class="string">' Hello World            '</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>text.rjust(<span class="number">20</span>)</span><br><span class="line"><span class="string">'            Hello World '</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>text.center(<span class="number">20</span>)</span><br><span class="line"><span class="string">'       Hello World      '</span></span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>
<p>还有就是<code>format()</code>函数：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># &gt; &lt;　＾　分别是居左，居右，居中</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>format(text, <span class="string">'&gt;20'</span>)</span><br><span class="line"><span class="string">'       Hello World'</span></span><br><span class="line">＃　也可以在字符串格式化中用</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'&#123;:&gt;10s&#125; &#123;:&gt;10s&#125;'</span>.format(<span class="string">'Hello'</span>, <span class="string">'World'</span>)</span><br><span class="line"><span class="string">'    Hello　　 World '</span></span><br></pre></td></tr></table></figure>
<p>最后，老代码中的％操作符来格式化字符串就不细说啦</p>
<h3 id="2-14-合并拼接字符串"><a href="#2-14-合并拼接字符串" class="headerlink" title="2.14 合并拼接字符串"></a>2.14 合并拼接字符串</h3><p><strong>Q: 你想将几个小的字符串合并为一个大的字符串</strong></p>
<p>A: <code>&#39; &#39;.join(str)</code> 和”+”操作符都可以合并字符串，比较简单就不举例了</p>
<h3 id="2-15-字符串中插入变量"><a href="#2-15-字符串中插入变量" class="headerlink" title="2.15 字符串中插入变量"></a>2.15 字符串中插入变量</h3><p><strong>Q: 你想创建一个内嵌变量的字符串，变量被它的值所表示的字符串替换掉。</strong></p>
<p>A: 这里推荐python3.6版本的新特性: <strong>f-string</strong> :</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>name = <span class="string">"Lee"</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>n = <span class="number">666</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s = <span class="string">f'<span class="subst">&#123;name&#125;</span> has <span class="subst">&#123;n&#125;</span> messages.'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s</span><br><span class="line"><span class="string">'Lee has 666 messages.'</span></span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>
<h3 id="2-16-以指定列宽格式化字符串"><a href="#2-16-以指定列宽格式化字符串" class="headerlink" title="2.16 以指定列宽格式化字符串"></a>2.16 以指定列宽格式化字符串</h3><p><strong>Q: 你有一些长字符串，想以指定的列宽将它们重新格式化。</strong></p>
<p>A: 使用<code>textwrap</code> 模块来格式化字符串的输出:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> textwrap</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(textwrap.fill(s, <span class="number">70</span>)) <span class="comment"># 宽度70</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(textwrap.fill(s, <span class="number">40</span>, initial_indent=<span class="string">'  '</span>)) <span class="comment"># 宽度40，首行空两格</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(textwrap.fill(s, <span class="number">40</span>, subsequent_indent=<span class="string">'  '</span>)) <span class="comment"># 宽度40，非首行空两格</span></span><br></pre></td></tr></table></figure>
<h3 id="2-17-在字符串中处理html-和xml"><a href="#2-17-在字符串中处理html-和xml" class="headerlink" title="2.17 在字符串中处理html 和xml"></a>2.17 在字符串中处理html 和xml</h3><p><strong>Q: 你想将HTML 或者XML 实体如&entity; 或&#code; 替换为对应的文本。再者，你需要转换文本中特定的字符(比如&lt;, &gt;, 或&amp;)。</strong></p>
<p>A: 使用<code>html.escape()</code></p>
<h3 id="2-18-字符串令牌解析"><a href="#2-18-字符串令牌解析" class="headerlink" title="2.18 字符串令牌解析"></a>2.18 字符串令牌解析</h3><p><strong>Q: 你有一个字符串，想从左至右将其解析为一个令牌流。</strong></p>
<p>A: 看不懂题目</p>
<h3 id="2-19-实现一个简单的递归下降分析器"><a href="#2-19-实现一个简单的递归下降分析器" class="headerlink" title="2.19 实现一个简单的递归下降分析器"></a>2.19 实现一个简单的递归下降分析器</h3><p><strong>Q: 你想根据一组语法规则解析文本并执行命令，或者构造一个代表输入的抽象语法树。如果语法非常简单，你可以自己写这个解析器，而不是使用一些框架。</strong></p>
<p>A: 看不懂答案</p>
<h3 id="2-20-字节字符串上的字符串操作"><a href="#2-20-字节字符串上的字符串操作" class="headerlink" title="2.20 字节字符串上的字符串操作"></a>2.20 字节字符串上的字符串操作</h3><p><strong>Q: 你想在字节字符串上执行普通的文本操作(比如移除，搜索和替换)。</strong></p>
<p>A: 与普通文本字符串的操作没啥差别，需要注意的是使用正则表达式的时候要加<code>b</code>:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>data = <span class="string">b'FOO:BAR,SPAM'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> re</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>re.split(<span class="string">b'[:,]'</span>, data)</span><br></pre></td></tr></table></figure>
<hr>
<hr>
<h2 id="第三章：数字日期和时间"><a href="#第三章：数字日期和时间" class="headerlink" title="第三章：数字日期和时间"></a>第三章：数字日期和时间</h2><h3 id="3-1-数字的四舍五入"><a href="#3-1-数字的四舍五入" class="headerlink" title="3.1 数字的四舍五入"></a>3.1 数字的四舍五入</h3><p><strong>Q:你想对浮点数执行指定精度的舍入运算</strong></p>
<p>A: 简单的用<code>round(value, ndigits)</code> 函数, 也可以格式化</p>
<h3 id="3-2-执行精确的浮点数运算"><a href="#3-2-执行精确的浮点数运算" class="headerlink" title="3.2 执行精确的浮点数运算"></a>3.2 执行精确的浮点数运算</h3><p><strong>Q: 你需要对浮点数执行精确的计算操作，并且不希望有任何小误差的出现。</strong></p>
<p>A: 科学计算用<code>decimal</code> 模块</p>
<h3 id="3-3-数字的格式化输出"><a href="#3-3-数字的格式化输出" class="headerlink" title="3.3 数字的格式化输出"></a>3.3 数字的格式化输出</h3><p><strong>Q: 你需要将数字格式化后输出，并控制数字的位数、对齐、千位分隔符和其他的细节。</strong></p>
<p>A: 跟字符串格式化输出一样，使用<code>format</code>函数</p>
<h3 id="3-4-二八十六进制整数"><a href="#3-4-二八十六进制整数" class="headerlink" title="3.4 二八十六进制整数"></a>3.4 二八十六进制整数</h3><p><strong>Q: 你需要转换或者输出使用二进制，八进制或十六进制表示的整数。</strong></p>
<p>A: 了将整数转换为二进制、八进制或十六进制的文本串，可以分别使用<code>bin()</code> ,<code>oct()</code> 或<code>hex()</code> 函数：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>x = <span class="number">1234</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>bin(x)</span><br><span class="line"><span class="string">'0b10011010010'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>oct(x)</span><br><span class="line"><span class="string">'0o2322'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>hex(x)</span><br><span class="line"><span class="string">'0x4d2'</span></span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>
<h3 id="3-5-字节到大整数的打包与解包"><a href="#3-5-字节到大整数的打包与解包" class="headerlink" title="3.5 字节到大整数的打包与解包"></a>3.5 字节到大整数的打包与解包</h3><p><strong>Q: 你有一个字节字符串并想将它解压成一个整数。或者，你需要将一个大整数转换为一个字节字符串。</strong></p>
<p>A: 字节转整数用<code>int.from_bytes()</code>,整数转字节用<code>int.to_bytes()</code></p>
<h3 id="3-6-复数的数学运算-略"><a href="#3-6-复数的数学运算-略" class="headerlink" title="3.6 复数的数学运算(略)"></a>3.6 复数的数学运算(略)</h3><h3 id="3-7-无穷大与NaN-略"><a href="#3-7-无穷大与NaN-略" class="headerlink" title="3.7 无穷大与NaN(略)"></a>3.7 无穷大与NaN(略)</h3><h3 id="3-8-分数运算-略"><a href="#3-8-分数运算-略" class="headerlink" title="3.8 分数运算(略)"></a>3.8 分数运算(略)</h3><h3 id="3-9-大型数组运算"><a href="#3-9-大型数组运算" class="headerlink" title="3.9 大型数组运算"></a>3.9 大型数组运算</h3><p><strong>Q: 你需要在大数据集(比如数组或网格) 上面执行计算。</strong></p>
<p>A: 请参阅numpy和pandas库</p>
<h3 id="3-10-矩阵与线性代数运算-略"><a href="#3-10-矩阵与线性代数运算-略" class="headerlink" title="3.10 矩阵与线性代数运算(略)"></a>3.10 矩阵与线性代数运算(略)</h3><h3 id="3-11-随机选择"><a href="#3-11-随机选择" class="headerlink" title="3.11 随机选择"></a>3.11 随机选择</h3><p><strong>Q: 你想从一个序列中随机抽取若干元素，或者想生成几个随机数。</strong></p>
<p>A: 请使用<code>random</code>模块，除了生成随机数随机序列，还可以生成均匀分布、高斯分布等其他函数，随机数的生成也可以设置初始化种子(<code>random.seed()</code>)</p>
<h3 id="3-12-基本的日期与时间转换"><a href="#3-12-基本的日期与时间转换" class="headerlink" title="3.12 基本的日期与时间转换"></a>3.12 基本的日期与时间转换</h3><p><strong>Q:你需要执行简单的时间转换，比如天到秒，小时到分钟等的转换。</strong></p>
<p>A: 日期与时间处理用<code>datetime</code>模块</p>
<h3 id="3-13-计算最后一个周五的日期-略"><a href="#3-13-计算最后一个周五的日期-略" class="headerlink" title="3.13 计算最后一个周五的日期(略)"></a>3.13 计算最后一个周五的日期(略)</h3><h3 id="3-14-计算当前月份的日期范围-略"><a href="#3-14-计算当前月份的日期范围-略" class="headerlink" title="3.14 计算当前月份的日期范围(略)"></a>3.14 计算当前月份的日期范围(略)</h3><h3 id="3-15-字符串转换为日期"><a href="#3-15-字符串转换为日期" class="headerlink" title="3.15 字符串转换为日期"></a>3.15 字符串转换为日期</h3><p><strong>Q: 你的应用程序接受字符串格式的输入，但是你想将它们转换为datetime 对象以便在上面执行非字符串操作。</strong></p>
<p>A:  一个简单的时间格式化问题：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>t = <span class="string">'2012-09-20'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>y = datetime.strptime(t,<span class="string">'%Y-%m-%d'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>z = datetime.now()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>y</span><br><span class="line">datetime.datetime(<span class="number">2012</span>, <span class="number">9</span>, <span class="number">20</span>, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>z</span><br><span class="line">datetime.datetime(<span class="number">2018</span>, <span class="number">12</span>, <span class="number">19</span>, <span class="number">22</span>, <span class="number">1</span>, <span class="number">9</span>, <span class="number">914504</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>z-y</span><br><span class="line">datetime.timedelta(<span class="number">2281</span>, <span class="number">79269</span>, <span class="number">914504</span>)</span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>
<hr>
<hr>
<h2 id="第四章：迭代器与生成器"><a href="#第四章：迭代器与生成器" class="headerlink" title="第四章：迭代器与生成器"></a>第四章：迭代器与生成器</h2><h3 id="4-1-手动遍历迭代器"><a href="#4-1-手动遍历迭代器" class="headerlink" title="4.1 手动遍历迭代器"></a>4.1 手动遍历迭代器</h3><p><strong>Q: 你想遍历一个可迭代对象中的所有元素，但是却不想使用for 循环。</strong></p>
<p>A: 使用<code>next()</code>函数来获取下一个对象：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>list = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a = iter(list) <span class="comment"># 转换成可迭代对象才可以使用next方法</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>next(a)</span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>next(a)</span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>next(a)</span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>next(a)</span><br><span class="line"><span class="number">4</span></span><br></pre></td></tr></table></figure>
<h3 id="4-2-代理迭代"><a href="#4-2-代理迭代" class="headerlink" title="4.2 代理迭代"></a>4.2 代理迭代</h3><p><strong>Q: 你构建了一个自定义容器对象，里面包含有列表、元组或其他可迭代对象。你想直接在你的这个新容器对象上执行迭代操作。</strong></p>
<p>A: 给对象定义一个<code>__iter__</code>方法就好：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">__iter__</span><span class="params">(self)</span> :</span></span><br><span class="line">    <span class="keyword">return</span> iter(self.items)</span><br></pre></td></tr></table></figure>
<h3 id="4-3-使用生成器创建新的迭代模式"><a href="#4-3-使用生成器创建新的迭代模式" class="headerlink" title="4.3 使用生成器创建新的迭代模式"></a>4.3 使用生成器创建新的迭代模式</h3><p><strong>Q: 你想实现一个自定义迭代模式，跟普通的内置函数比如<code>range()</code> , <code>reversed()</code> 不一样。</strong></p>
<p>A: <code>yield</code>就是一个生成器函数，生成一个迭代对象</p>
<h3 id="4-4-实现迭代器协议"><a href="#4-4-实现迭代器协议" class="headerlink" title="4.4 实现迭代器协议"></a>4.4 实现迭代器协议</h3><p><strong>Q: 你想构建一个能支持迭代操作的自定义对象，并希望找到一个能实现迭代协议的简单方法。</strong></p>
<p>A: 其实就是想自己定义迭代的方法，那就定义一个<code>__next__</code>方法就好</p>
<h3 id="4-5-反向迭代"><a href="#4-5-反向迭代" class="headerlink" title="4.5 反向迭代"></a>4.5 反向迭代</h3><p><strong>Q: 你想反方向迭代一个序列</strong></p>
<p>A: 用<code>reversed()</code>函数，<del>先有韦神后有天，反向迭代耗时间</del></p>
<h3 id="4-6-带有外部状态的生成器函数"><a href="#4-6-带有外部状态的生成器函数" class="headerlink" title="4.6 带有外部状态的生成器函数"></a>4.6 带有外部状态的生成器函数</h3><p><strong>Q: 你想定义一个生成器函数，但是它会调用某个你想暴露给用户使用的外部状态值。</strong></p>
<p>A: 如果你想让你的生成器暴露外部状态给用户，别忘了你可以简单的将它实现为一<br>个类，然后把生成器函数放到<code>__iter__()</code> 方法中过去</p>
<h3 id="4-7-迭代器切片"><a href="#4-7-迭代器切片" class="headerlink" title="4.7 迭代器切片"></a>4.7 迭代器切片</h3><p><strong>Q: 你想得到一个由迭代器生成的切片对象，但是标准切片操作并不能做到。</strong></p>
<p>A: 函数<code>itertools.islice()</code>: </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="function"><span class="keyword">def</span> <span class="title">count</span><span class="params">(n)</span>:</span></span><br><span class="line"><span class="meta">... </span><span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line"><span class="meta">... </span><span class="keyword">yield</span> n</span><br><span class="line"><span class="meta">... </span>n += <span class="number">1</span></span><br><span class="line">...</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>c = count(<span class="number">0</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>c[<span class="number">10</span>:<span class="number">20</span>] <span class="comment"># 会报错</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> itertools</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> x <span class="keyword">in</span> itertools.islice(c, <span class="number">10</span>, <span class="number">20</span>):</span><br><span class="line"><span class="meta">... </span>print(x)</span><br><span class="line">...</span><br><span class="line"><span class="number">10</span> <span class="comment"># 一直到20</span></span><br></pre></td></tr></table></figure>
<h3 id="4-8-跳过可迭代对象的开始部分"><a href="#4-8-跳过可迭代对象的开始部分" class="headerlink" title="4.8 跳过可迭代对象的开始部分"></a>4.8 跳过可迭代对象的开始部分</h3><p><strong>Q: 你想遍历一个可迭代对象，但是它开始的某些元素你并不感兴趣，想跳过它们。</strong></p>
<p>A: <code>itertools.dropwhile()</code>函数可以做到，比如跳过文件开头几行的注释：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> itertools <span class="keyword">import</span> dropwhile</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">with</span> open(<span class="string">'/etc/passwd'</span>) <span class="keyword">as</span> f:</span><br><span class="line"><span class="meta">... </span><span class="keyword">for</span> line <span class="keyword">in</span> dropwhile(<span class="keyword">lambda</span> line: line.startswith(<span class="string">'#'</span>), f):</span><br><span class="line"><span class="meta">... </span>print(line, end=<span class="string">''</span>)</span><br><span class="line">...</span><br><span class="line">nobody:*:<span class="number">-2</span>:<span class="number">-2</span>:Unprivileged User:/var/empty:/usr/bin/false</span><br><span class="line">root:*:<span class="number">0</span>:<span class="number">0</span>:System Administrator:/var/root:/bin/sh</span><br><span class="line">...</span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>
<h3 id="4-9-排列组合的迭代"><a href="#4-9-排列组合的迭代" class="headerlink" title="4.9 排列组合的迭代"></a>4.9 排列组合的迭代</h3><p><strong>Q: 你想迭代遍历一个集合中元素的所有可能的排列或组合</strong></p>
<p>A: 去看一下<code>itertools.permutations()</code>,<code>itertools.combinations()</code>, <code>itertools.combinations_with_replacement</code>使用方法就好了</p>
<h3 id="4-10-序列上索引值迭代"><a href="#4-10-序列上索引值迭代" class="headerlink" title="4.10 序列上索引值迭代"></a>4.10 序列上索引值迭代</h3><p><strong>Q:你想在迭代一个序列的同时跟踪正在被处理的元素索引。</strong></p>
<p>A: 这个简单，用<code>enumerate()</code></p>
<h3 id="4-11-同时迭代多个序列"><a href="#4-11-同时迭代多个序列" class="headerlink" title="4.11 同时迭代多个序列"></a>4.11 同时迭代多个序列</h3><p><strong>Q: 你想同时迭代多个序列，每次分别从一个序列中取一个元素</strong></p>
<p>A: 章口就莱：<code>zip()</code></p>
<h3 id="4-12-不同集合上元素的迭代"><a href="#4-12-不同集合上元素的迭代" class="headerlink" title="4.12 不同集合上元素的迭代"></a>4.12 不同集合上元素的迭代</h3><p><strong>Q: 你想在多个对象执行相同的操作，但是这些对象在不同的容器中，你希望代码在不失可读性的情况下避免写重复的循环。</strong></p>
<p>A: 其实你把这个两个对象合在一起就好了，但是这样做就会有多余的赋值操作，所以就可以用<code>itertools.chain()</code>函数了：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> itertools <span class="keyword">import</span> chain</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>b = [<span class="string">'x'</span>, <span class="string">'y'</span>, <span class="string">'z'</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> x <span class="keyword">in</span> chain(a, b): <span class="comment"># 等价于 for x in a+b</span></span><br><span class="line"><span class="meta">... </span>print(x)</span><br><span class="line">...</span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="number">4</span></span><br><span class="line">x</span><br><span class="line">y</span><br><span class="line">z</span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>
<h3 id="4-13-创建数据处理管道"><a href="#4-13-创建数据处理管道" class="headerlink" title="4.13 创建数据处理管道"></a>4.13 创建数据处理管道</h3><p><strong>Q: 你想以数据管道(类似Unix 管道) 的方式迭代处理数据。比如，你有个大量的数据需要处理，但是不能将它们一次性放入内存中</strong></p>
<p>A: 这个还是看书吧，书中的例子将的比较详细，注意一下<code>yiled</code>和<code>yield from</code>用法</p>
<h3 id="4-14-展开嵌套的序列"><a href="#4-14-展开嵌套的序列" class="headerlink" title="4.14 展开嵌套的序列"></a>4.14 展开嵌套的序列</h3><p><strong>Q: 你想将一个多层嵌套的序列展开成一个单层列表</strong></p>
<p>A: 详见<code>yield from</code> 用法</p>
<h3 id="4-15-顺序迭代合并后的排序迭代对象"><a href="#4-15-顺序迭代合并后的排序迭代对象" class="headerlink" title="4.15 顺序迭代合并后的排序迭代对象"></a>4.15 顺序迭代合并后的排序迭代对象</h3><p><strong>Q: 你有一系列排序序列，想将它们合并后得到一个排序序列并在上面迭代遍历。</strong></p>
<p>A: <code>heapq.merge()</code> 函数可以帮你解决这个问题</p>
<h3 id="4-16-迭代器代替while-无限循环"><a href="#4-16-迭代器代替while-无限循环" class="headerlink" title="4.16 迭代器代替while 无限循环"></a>4.16 迭代器代替while 无限循环</h3><p><strong>Q: 你在代码中使用while 循环来迭代处理数据，因为它需要调用某个函数或者和一般迭代模式不同的测试条件。能不能用迭代器来重写这个循环呢？</strong></p>
<p>A: 可以用<code>iter()</code>函数转成可迭代对象，然后就可以用for循环啦</p>
<hr>
<hr>
<h2 id="第五章：文件与IO"><a href="#第五章：文件与IO" class="headerlink" title="第五章：文件与IO"></a>第五章：文件与IO</h2><h3 id="5-1-读写文本数据"><a href="#5-1-读写文本数据" class="headerlink" title="5.1 读写文本数据"></a>5.1 读写文本数据</h3><p><strong>Q: 你需要读写各种不同编码的文本数据，比如ASCII，UTF-8 或UTF-16 编码等。</strong></p>
<p>A: <code>open</code>函数的<code>encoding</code>参数可以解决这个问题</p>
<h3 id="5-2-打印输出至文件中"><a href="#5-2-打印输出至文件中" class="headerlink" title="5.2 打印输出至文件中"></a>5.2 打印输出至文件中</h3><p><strong>Q: 你想将print() 函数的输出重定向到一个文件中去。</strong></p>
<p>A: <code>print</code>函数有个<code>file</code>参数可以指定文件</p>
<h3 id="5-3-使用其他分隔符或行终止符打印"><a href="#5-3-使用其他分隔符或行终止符打印" class="headerlink" title="5.3 使用其他分隔符或行终止符打印"></a>5.3 使用其他分隔符或行终止符打印</h3><p><strong>Q: 你想使用print() 函数输出数据，但是想改变默认的分隔符或者行尾符。</strong></p>
<p>A: <code>print()</code> 函数中使用<code>sep</code> 和<code>end</code> 关键字参数</p>
<h3 id="5-4-读写字节数据"><a href="#5-4-读写字节数据" class="headerlink" title="5.4 读写字节数据"></a>5.4 读写字节数据</h3><p><strong>Q: 你想读写二进制文件，比如图片，声音文件等等。</strong></p>
<p>A: <code>open</code>函数的<code>rb</code>,<code>wb</code>可以读写二进制文件</p>
<h3 id="5-5-文件不存在才能写入"><a href="#5-5-文件不存在才能写入" class="headerlink" title="5.5 文件不存在才能写入"></a>5.5 文件不存在才能写入</h3><p><strong>Q: 你想像一个文件中写入数据，但是前提必须是这个文件在文件系统上不存在。也就是不允许覆盖已存在的文件内容。</strong></p>
<p>A: <code>w</code>模式默认会清空文件，那就换成<code>x</code>模式就好</p>
<h3 id="5-6-字符串的I-O-操作"><a href="#5-6-字符串的I-O-操作" class="headerlink" title="5.6 字符串的I/O 操作"></a>5.6 字符串的I/O 操作</h3><p><strong>Q: 你想使用操作类文件对象的程序来操作文本或二进制字符串。</strong></p>
<p>A: 使用<code>io.StringIO()</code>和<code>io.BytesIO</code>类：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>s = io.StringIO()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s.write(<span class="string">'Hello World\n'</span>)</span><br><span class="line"><span class="number">12</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">'This is a test'</span>, file=s)</span><br><span class="line"><span class="number">15</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="comment"># Get all of the data written so far</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s.getvalue() <span class="comment"># 注意此时文件指针是指向末尾的，所以你用s.read()是读不出来的</span></span><br><span class="line"><span class="string">'Hello World\nThis is a test\n'</span></span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="comment"># Wrap a file interface around an existing string</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s = io.StringIO(<span class="string">'Hello\nWorld\n'</span>) <span class="comment"># 指针在开始出</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s.read(<span class="number">4</span>)</span><br><span class="line"><span class="string">'Hell'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s.read()</span><br><span class="line"><span class="string">'o\nWorld\n'</span></span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>
<h3 id="5-7-读写压缩文件"><a href="#5-7-读写压缩文件" class="headerlink" title="5.7 读写压缩文件"></a>5.7 读写压缩文件</h3><p><strong>Q: 你想读写一个gzip 或bz2 格式的压缩文件。</strong></p>
<p>A: 用<code>gzip</code>和<code>bz2</code>模块的<code>open</code>函数</p>
<h3 id="5-8-固定大小记录的文件迭代"><a href="#5-8-固定大小记录的文件迭代" class="headerlink" title="5.8 固定大小记录的文件迭代"></a>5.8 固定大小记录的文件迭代</h3><p><strong>Q: 你想在一个固定长度记录或者数据块的集合上迭代，而不是在一个文件中一行一行的迭代。</strong></p>
<p>A: 方法倒是有，不过我不觉得有必要这样做：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> partial</span><br><span class="line">RECORD_SIZE = <span class="number">32</span></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'somefile.data'</span>, <span class="string">'rb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    records = iter(partial(f.read, RECORD_SIZE), <span class="string">b''</span>)</span><br><span class="line">    <span class="keyword">for</span> r <span class="keyword">in</span> records:</span><br><span class="line">        ...<span class="comment">#　输出</span></span><br></pre></td></tr></table></figure>
<h3 id="5-9-读取二进制数据到可变缓冲区中"><a href="#5-9-读取二进制数据到可变缓冲区中" class="headerlink" title="5.9 读取二进制数据到可变缓冲区中"></a>5.9 读取二进制数据到可变缓冲区中</h3><p><strong>Q: 你想直接读取二进制数据到一个可变缓冲区中，而不需要做任何的中间复制操作。或者你想原地修改数据并将它写回到一个文件中去。</strong></p>
<p>A: <code>readinto()</code>函数就是将文件数据读取到一个数组中去：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os.path</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">read_into_buffer</span><span class="params">(filename)</span>:</span></span><br><span class="line">buf = bytearray(os.path.getsize(filename)) <span class="comment"># 此时的buf是一个二进制的数组</span></span><br><span class="line"><span class="keyword">with</span> open(filename, <span class="string">'rb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">f.readinto(buf)</span><br><span class="line"><span class="keyword">return</span> buf</span><br></pre></td></tr></table></figure>
<p>和普通<code>read()</code> 方法不同的是，<code>readinto()</code> 填充已存在的缓冲区而不是为新对象重新分配内存再返回它们</p>
<h3 id="5-10-内存映射的二进制文件"><a href="#5-10-内存映射的二进制文件" class="headerlink" title="5.10 内存映射的二进制文件"></a>5.10 内存映射的二进制文件</h3><p><strong>Q: 你想内存映射一个二进制文件到一个可变字节数组中，目的可能是为了随机访问它的内容或者是原地做些修改。</strong></p>
<p>A: <code>mmap</code>模块可以解决这个问题，有需要的去看<a href="https://docs.python.org/3/library/mmap.html" target="_blank" rel="noopener">官方文档</a>吧，这里就不介绍了</p>
<h3 id="5-11-文件路径名的操作"><a href="#5-11-文件路径名的操作" class="headerlink" title="5.11 文件路径名的操作"></a>5.11 文件路径名的操作</h3><p><strong>Q: 你需要使用路径名来获取文件名，目录名，绝对路径等等。</strong></p>
<p>A: <code>os.path</code>模块就不用我多说了吧</p>
<h3 id="5-12-测试文件是否存在"><a href="#5-12-测试文件是否存在" class="headerlink" title="5.12 测试文件是否存在"></a>5.12 测试文件是否存在</h3><p><strong>Q: 你想测试一个文件或目录是否存在。</strong></p>
<p>A: <code>os.path.isfile()</code>, <code>os.path.isdir()</code>, <code>os.path.islink()</code> , <code>os.path.realpath()</code>, <code>os.path.abspath</code>, <code>os.path.getsize()</code>…</p>
<h3 id="5-13-获取文件夹中的文件列表"><a href="#5-13-获取文件夹中的文件列表" class="headerlink" title="5.13 获取文件夹中的文件列表"></a>5.13 获取文件夹中的文件列表</h3><p><strong>Q: 你想获取文件系统中某个目录下的所有文件列表。</strong></p>
<p>A: <code>os.listdir()</code></p>
<h3 id="5-14-忽略文件名编码"><a href="#5-14-忽略文件名编码" class="headerlink" title="5.14 忽略文件名编码"></a>5.14 忽略文件名编码</h3><p><strong>Q: 你想使用原始文件名执行文件的I/O 操作，也就是说文件名并没有经过系统默认编码去解码或编码过。</strong></p>
<p>A: 既然文件名编码不知道，那就统一用字节名吧，然后用字节名当做文件名读写：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> open(<span class="string">b'jalapen\xcc\x83o.txt'</span>) <span class="keyword">as</span> f:</span><br></pre></td></tr></table></figure>
<h3 id="5-15-打印不合法的文件名"><a href="#5-15-打印不合法的文件名" class="headerlink" title="5.15 打印不合法的文件名"></a>5.15 打印不合法的文件名</h3><p><strong>Q: 你的程序获取了一个目录中的文件名列表，但是当它试着去打印文件名的时候程序崩溃，出现了UnicodeEncodeError 异常和一条奇怪的消息——surrogates notallowed 。</strong></p>
<p>A: 解决方法：<code>repr(filename)[1:-1]</code>这样就将一些奇奇怪怪的字正确显示</p>
<h3 id="5-16-增加或改变已打开文件的编码"><a href="#5-16-增加或改变已打开文件的编码" class="headerlink" title="5.16 增加或改变已打开文件的编码"></a>5.16 增加或改变已打开文件的编码</h3><p><strong>Q: 你想在不关闭一个已打开的文件前提下增加或改变它的Unicode 编码。</strong></p>
<p>A: 我不建议这么做</p>
<h3 id="5-17-将字节写入文本文件"><a href="#5-17-将字节写入文本文件" class="headerlink" title="5.17 将字节写入文本文件"></a>5.17 将字节写入文本文件</h3><p><strong>Q: 你想在文本模式打开的文件中写入原始的字节数据。</strong></p>
<p>A: 将字节数据直接写入文件的缓冲区即可：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys`</span><br><span class="line">sys.stdout.buffer.write(<span class="string">b'Hello\n'</span>)</span><br></pre></td></tr></table></figure>
<h3 id="5-18-将文件描述符包装成文件对象"><a href="#5-18-将文件描述符包装成文件对象" class="headerlink" title="5.18 将文件描述符包装成文件对象"></a>5.18 将文件描述符包装成文件对象</h3><p><strong>Q: 你有一个对应于操作系统上一个已打开的I/O 通道(比如文件、管道、套接字等)的整型文件描述符，你想将它包装成一个更高层的Python 文件对象</strong></p>
<p>A: 包装文件描述符的技术可以很方便的将一个类文件接口作用于一个以不同方式打开的I/O 通道上，如管道、套接字等，有需要的自己去查资料吧</p>
<h3 id="5-19-创建临时文件和文件夹"><a href="#5-19-创建临时文件和文件夹" class="headerlink" title="5.19 创建临时文件和文件夹"></a>5.19 创建临时文件和文件夹</h3><p><strong>Q: 你需要在程序执行时创建一个临时文件或目录，并希望使用完之后可以自动销毁掉。</strong></p>
<p>A: <code>tempfile</code> 模块的<code>TemporaryFile()</code>、<code>NamedTemporaryFile()</code> 和<code>TemporaryDirectory()</code> 函数<br>可以满足需求</p>
<h3 id="5-20-与串行端口的数据通信"><a href="#5-20-与串行端口的数据通信" class="headerlink" title="5.20 与串行端口的数据通信"></a>5.20 与串行端口的数据通信</h3><p><strong>Q: 你想通过串行端口读写数据，典型场景就是和一些硬件设备打交道(比如一个机器人或传感器)。</strong></p>
<p>A: 请使用<a href="https://pyserial.readthedocs.io/en/latest/" target="_blank" rel="noopener"><code>pySerial</code></a></p>
<h3 id="5-21-序列化Python-对象"><a href="#5-21-序列化Python-对象" class="headerlink" title="　5.21 序列化Python 对象"></a>　5.21 序列化Python 对象</h3><p><strong>Q: 你需要将一个Python 对象序列化为一个字节流，以便将它保存到一个文件、存储到数据库或者通过网络传输它。</strong></p>
<p>A: 请使用<code>pickle.load</code>, <code>pickle.loads</code>, <code>pickle.dump</code>, <code>pickle.dumps</code></p>
<hr>
<hr>
<h2 id="第六章：数据编码和处理"><a href="#第六章：数据编码和处理" class="headerlink" title="第六章：数据编码和处理"></a>第六章：数据编码和处理</h2><h3 id="6-1-读写CSV-数据"><a href="#6-1-读写CSV-数据" class="headerlink" title="6.1 读写CSV 数据"></a>6.1 读写CSV 数据</h3><p><strong>Q: 你想读写一个CSV 格式的文件。</strong></p>
<p>A: 请看示例：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> csv</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'stocks.csv'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f_csv = csv.reader(f)</span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> f_csv:</span><br><span class="line">        <span class="comment"># 其他操作</span></span><br><span class="line">        <span class="comment"># 请注意这里的row是一个列表，是自动以逗号分隔的</span></span><br></pre></td></tr></table></figure>
<h3 id="6-2-读写JSON-数据"><a href="#6-2-读写JSON-数据" class="headerlink" title="6.2 读写JSON 数据"></a>6.2 读写JSON 数据</h3><p><strong>Q: 你想读写JSON(JavaScript Object Notation) 编码格式的数据。</strong></p>
<p>A: <code>json.loads</code>读取JSON格式，<code>json.dumps</code>转换为JSON格式，对应的文件读写方法是：<code>json.dump</code>, <code>json.load</code></p>
<h3 id="6-3-解析简单的XML-数据"><a href="#6-3-解析简单的XML-数据" class="headerlink" title="6.3 解析简单的XML 数据"></a>6.3 解析简单的XML 数据</h3><p><strong>Q: 你想从一个简单的XML 文档中提取数据。</strong></p>
<p>A: 可以试一下<code>xml.etree.ElementTree</code>模块的<code>parse</code>函数</p>
<h3 id="6-4-增量式解析大型XML-文件"><a href="#6-4-增量式解析大型XML-文件" class="headerlink" title="6.4 增量式解析大型XML 文件"></a>6.4 增量式解析大型XML 文件</h3><p><strong>Q: 你想使用尽可能少的内存从一个超大的XML 文档中提取数据。</strong></p>
<p>A: 任何时候只要你遇到增量式的数据处理时，第一时间就应该想到迭代器和生成器。示例略</p>
<h3 id="6-5-将字典转换为XML-略"><a href="#6-5-将字典转换为XML-略" class="headerlink" title="6.5 将字典转换为XML(略)"></a>6.5 将字典转换为XML(略)</h3><h3 id="6-6-解析和修改XML-略"><a href="#6-6-解析和修改XML-略" class="headerlink" title="6.6 解析和修改XML(略)"></a>6.6 解析和修改XML(略)</h3><h3 id="6-7-利用命名空间解析XML-文档-略"><a href="#6-7-利用命名空间解析XML-文档-略" class="headerlink" title="6.7 利用命名空间解析XML 文档(略)"></a>6.7 利用命名空间解析XML 文档(略)</h3><h3 id="6-8-与关系型数据库的交互"><a href="#6-8-与关系型数据库的交互" class="headerlink" title="6.8 与关系型数据库的交互"></a>6.8 与关系型数据库的交互</h3><p><strong>Q: 你想在关系型数据库中查询、增加或删除记录</strong></p>
<p>A: 可以使用内置的<code>sqlite3 模块</code>， 安装其他模块也可以</p>
<h3 id="6-9-编码和解码十六进制数"><a href="#6-9-编码和解码十六进制数" class="headerlink" title="6.9 编码和解码十六进制数"></a>6.9 编码和解码十六进制数</h3><p><strong>Q: 你想将一个十六进制字符串解码成一个字节字符串或者将一个字节字符串编码成一个十六进制字符串。</strong></p>
<p>A: <code>base64.b16decode()</code> 和<code>base64.b16encode()</code></p>
<h3 id="6-10-编码解码Base64-数据"><a href="#6-10-编码解码Base64-数据" class="headerlink" title="6.10 编码解码Base64 数据"></a>6.10 编码解码Base64 数据</h3><p><strong>Q: 你需要使用Base64 格式解码或编码二进制数据。</strong></p>
<p>A: <code>base64.b64decode()</code> 和<code>base64.b64encode()</code></p>
<h3 id="6-11-读写二进制数组数据-略"><a href="#6-11-读写二进制数组数据-略" class="headerlink" title="6.11 读写二进制数组数据(略)"></a>6.11 读写二进制数组数据(略)</h3><h3 id="6-12-读取嵌套和可变长二进制数据-略"><a href="#6-12-读取嵌套和可变长二进制数据-略" class="headerlink" title="6.12 读取嵌套和可变长二进制数据(略)"></a>6.12 读取嵌套和可变长二进制数据(略)</h3><h3 id="6-13-数据的累加与统计操作-略"><a href="#6-13-数据的累加与统计操作-略" class="headerlink" title="6.13 数据的累加与统计操作(略)"></a>6.13 数据的累加与统计操作(略)</h3><hr>
<hr>
<h2 id="第七章：函数"><a href="#第七章：函数" class="headerlink" title="第七章：函数"></a>第七章：函数</h2><h3 id="7-1-可接受任意数量参数的函数"><a href="#7-1-可接受任意数量参数的函数" class="headerlink" title="7.1 可接受任意数量参数的函数"></a>7.1 可接受任意数量参数的函数</h3><p><strong>Q: 你想构造一个可接受任意数量参数的函数。</strong></p>
<p>A: 使用<code>*</code>任意位置参数和<code>**</code>任意关键字参数</p>
<h3 id="7-2-只接受关键字参数的函数"><a href="#7-2-只接受关键字参数的函数" class="headerlink" title="7.2 只接受关键字参数的函数"></a>7.2 只接受关键字参数的函数</h3><p><strong>Q: 你希望函数的某些参数强制使用关键字参数传递</strong></p>
<p>A: 将强制关键字参数放到某个<code>*</code> 参数或者单个<code>*</code> 后面就能达到这种效果。比如：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 强制最后一个参数必须输入</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">recv</span><span class="params">(maxsize, *, block)</span>:</span></span><br><span class="line">    <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>
<h3 id="7-3-给函数参数增加元信息"><a href="#7-3-给函数参数增加元信息" class="headerlink" title="7.3 给函数参数增加元信息"></a>7.3 给函数参数增加元信息</h3><p><strong>Q: 你写好了一个函数，然后想为这个函数的参数增加一些额外的信息，这样的话其他使用者就能清楚的知道这个函数应该怎么使用。</strong></p>
<p>A: 使用函数注解：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(x:int, y:int)</span> -&gt; int:</span></span><br><span class="line">    <span class="keyword">return</span> x + y</span><br></pre></td></tr></table></figure>
<h3 id="7-4-返回多个值的函数"><a href="#7-4-返回多个值的函数" class="headerlink" title="7.4 返回多个值的函数"></a>7.4 返回多个值的函数</h3><p><strong>Q: 你希望构造一个可以返回多个值的函数</strong></p>
<p>A: <code>return</code></p>
<h3 id="7-5-定义有默认参数的函数"><a href="#7-5-定义有默认参数的函数" class="headerlink" title="7.5 定义有默认参数的函数"></a>7.5 定义有默认参数的函数</h3><p><strong>Q: 你想定义一个函数或者方法，它的一个或多个参数是可选的并且有一个默认值。</strong></p>
<p>A:　这么简单就不回答了</p>
<h3 id="7-6-定义匿名或内联函数"><a href="#7-6-定义匿名或内联函数" class="headerlink" title="7.6 定义匿名或内联函数"></a>7.6 定义匿名或内联函数</h3><p><strong>你想为sort() 操作创建一个很短的回调函数，但又不想用def 去写一个单行函数，而是希望通过某个快捷方式以内联方式来创建这个函数。</strong></p>
<p>A: <code>lambda</code>表达式，但是只能指定单个表达式，它的值就是最后的返回值。</p>
<h3 id="7-7-匿名函数捕获变量值"><a href="#7-7-匿名函数捕获变量值" class="headerlink" title="7.7 匿名函数捕获变量值"></a>7.7 匿名函数捕获变量值</h3><p><strong>Q: 你用lambda 定义了一个匿名函数，并想在定义时捕获到某些变量的值。</strong></p>
<p>A: 这个问题看似很难懂，其实你只要明白下列代码的意思就懂了：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="keyword">lambda</span> y: x + y</span><br><span class="line">a = <span class="keyword">lambda</span> y, x=x: x + y</span><br><span class="line"><span class="comment">###</span></span><br><span class="line">funcs = [<span class="keyword">lambda</span> x: x+n <span class="keyword">for</span> n <span class="keyword">in</span> range(<span class="number">5</span>)]</span><br><span class="line">funcs = [<span class="keyword">lambda</span> x, n=n: x+n <span class="keyword">for</span> n <span class="keyword">in</span> range(<span class="number">5</span>)]</span><br></pre></td></tr></table></figure>
<h3 id="7-8-减少可调用对象的参数个数-待补充"><a href="#7-8-减少可调用对象的参数个数-待补充" class="headerlink" title="7.8 减少可调用对象的参数个数(待补充)"></a>7.8 减少可调用对象的参数个数(待补充)</h3><h3 id="7-9-将单方法的类转换为函数-待补充"><a href="#7-9-将单方法的类转换为函数-待补充" class="headerlink" title="7.9 将单方法的类转换为函数(待补充)"></a>7.9 将单方法的类转换为函数(待补充)</h3><h3 id="7-10-带额外状态信息的回调函数-待补充"><a href="#7-10-带额外状态信息的回调函数-待补充" class="headerlink" title="7.10 带额外状态信息的回调函数(待补充)"></a>7.10 带额外状态信息的回调函数(待补充)</h3><h3 id="7-11-内联回调函数-待补充"><a href="#7-11-内联回调函数-待补充" class="headerlink" title="7.11 内联回调函数(待补充)"></a>7.11 内联回调函数(待补充)</h3><h3 id="7-12-访问闭包中定义的变量-待补充"><a href="#7-12-访问闭包中定义的变量-待补充" class="headerlink" title="7.12 访问闭包中定义的变量(待补充)"></a>7.12 访问闭包中定义的变量(待补充)</h3><hr>
<hr>
<h2 id="第八章：类与对象"><a href="#第八章：类与对象" class="headerlink" title="第八章：类与对象"></a>第八章：类与对象</h2><h3 id="8-1-改变对象的字符串显示"><a href="#8-1-改变对象的字符串显示" class="headerlink" title="8.1 改变对象的字符串显示"></a>8.1 改变对象的字符串显示</h3><p><strong>Q: 你想改变对象实例的打印或显示输出，让它们更具可读性。</strong></p>
<p>A: 重新定义<code>__str__()</code>和<code>__repr__()</code>方法就好</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Pair</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, x, y)</span>:</span></span><br><span class="line">        self.x = x</span><br><span class="line">        self.y = y</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__repr__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">'Pair(&#123;0.x!r&#125;, &#123;0.y!r&#125;)'</span>.format(self)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">'(&#123;0.x!s&#125;, &#123;0.y!s&#125;)'</span>.format(self)</span><br></pre></td></tr></table></figure>
<p>使用方法</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>p = Pair(<span class="number">3</span>, <span class="number">4</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>p</span><br><span class="line">Pair(<span class="number">3</span>, <span class="number">4</span>) <span class="comment"># __repr__() output</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(p)</span><br><span class="line">(<span class="number">3</span>, <span class="number">4</span>) <span class="comment"># __str__() output</span></span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>
<h3 id="8-2-自定义字符串的格式化"><a href="#8-2-自定义字符串的格式化" class="headerlink" title="8.2 自定义字符串的格式化"></a>8.2 自定义字符串的格式化</h3><p><strong>Q: 你想通过format() 函数和字符串方法使得一个对象能支持自定义的格式化。</strong></p>
<p>A:  重新定义<code>__format__()</code>方法</p>
<h3 id="8-3-让对象支持上下文管理协议"><a href="#8-3-让对象支持上下文管理协议" class="headerlink" title="8.3 让对象支持上下文管理协议"></a>8.3 让对象支持上下文管理协议</h3><p><strong>Q:你想让你的对象支持上下文管理协议(with 语句)。</strong></p>
<p>A:  让你的对象实现<code>__enter__()</code>和<code>__exit__()</code>方法</p>
<h3 id="8-4-创建大量对象时节省内存方法"><a href="#8-4-创建大量对象时节省内存方法" class="headerlink" title="8.4 创建大量对象时节省内存方法"></a>8.4 创建大量对象时节省内存方法</h3><p><strong>Q: 你的程序要创建大量(可能上百万) 的对象，导致占用很大的内存。</strong></p>
<p>A: 给你的类添加<code>__slots__</code>把对象存入元组中</p>
<h3 id="8-5-在类中封装属性名"><a href="#8-5-在类中封装属性名" class="headerlink" title="8.5 在类中封装属性名"></a>8.5 在类中封装属性名</h3><p><strong>Q: 你想封装类的实例上面的“私有”数据，但是Python 语言并没有访问控制。</strong></p>
<p>A: 私有属性可以用单下划线的命名命名，若果以双下划线开头命名，那么访问方式会有所改变</p>
<h3 id="8-6-创建可管理的属性"><a href="#8-6-创建可管理的属性" class="headerlink" title="8.6 创建可管理的属性"></a>8.6 创建可管理的属性</h3><p><strong>Q: 你想给某个实例attribute 增加除访问与修改之外的其他处理逻辑，比如类型检查或合法性验证。</strong></p>
<p>A: <code>@property</code>装饰器可以设置getter 、setter 和deleter 方法</p>
<h3 id="8-7-调用父类方法"><a href="#8-7-调用父类方法" class="headerlink" title="8.7 调用父类方法"></a>8.7 调用父类方法</h3><p><strong>Q: 你想在子类中调用父类的某个已经被覆盖的方法。</strong></p>
<p>A: 在子类中使用<code>super()</code>函数</p>
<h3 id="8-8-子类中扩展property"><a href="#8-8-子类中扩展property" class="headerlink" title="8.8 子类中扩展property"></a>8.8 子类中扩展property</h3><p><strong>Q: 在子类中，你想要扩展定义在父类中的property 的功能。</strong></p>
<p>A: 直接继承并修改父类中的方法</p>
<h3 id="8-9-创建新的类或实例属性"><a href="#8-9-创建新的类或实例属性" class="headerlink" title="8.9 创建新的类或实例属性"></a>8.9 创建新的类或实例属性</h3><p><strong>Q: 你想创建一个新的拥有一些额外功能的实例属性类型，比如类型检查。</strong></p>
<p>A: <code>@property</code>装饰器是对<code>__get__()</code>, <code>__set__()</code>, <code>__delete__()</code>的实现，如果不想用装饰器，那就这几个函数重新定义就好</p>
<h3 id="8-10-使用延迟计算属性"><a href="#8-10-使用延迟计算属性" class="headerlink" title="8.10 使用延迟计算属性"></a>8.10 使用延迟计算属性</h3><p><strong>Q: 你想将一个只读属性定义成一个property，并且只在访问的时候才会计算结果。但是一旦被访问后，你希望结果值被缓存起来，不用每次都去计算。</strong></p>
<p>A: 只设置<code>@property.getter</code></p>
<h3 id="8-11-简化数据结构的初始化"><a href="#8-11-简化数据结构的初始化" class="headerlink" title="8.11 简化数据结构的初始化"></a>8.11 简化数据结构的初始化</h3><p><strong>Q: 你写了很多仅仅用作数据结构的类，不想写太多烦人的<strong>init</strong>() 函数</strong></p>
<p>A: 可以在一个基类中写一个公用的<code>__init__()</code> 函数, 用<code>setattr()</code>实现</p>
<h3 id="8-12-8-25-待补充"><a href="#8-12-8-25-待补充" class="headerlink" title="8.12 -8.25(待补充)"></a>8.12 -8.25(待补充)</h3><hr>
<hr>
<h2 id="第九章：元编程-待补充"><a href="#第九章：元编程-待补充" class="headerlink" title="第九章：元编程(待补充)"></a>第九章：元编程(待补充)</h2><hr>
<hr>
<h2 id="第十章：模块与包"><a href="#第十章：模块与包" class="headerlink" title="第十章：模块与包"></a>第十章：模块与包</h2><h3 id="10-1-构建一个模块的层级包"><a href="#10-1-构建一个模块的层级包" class="headerlink" title="10.1 构建一个模块的层级包"></a>10.1 构建一个模块的层级包</h3><p><strong>Q: 你想将你的代码组织成由很多分层模块构成的包。</strong></p>
<p>A: 封装成包是很简单的。在文件系统上组织你的代码，并确保每个目录都定义了一个<code>__init__.py</code> 文件</p>
<h3 id="10-2-控制模块被全部导入的内容"><a href="#10-2-控制模块被全部导入的内容" class="headerlink" title="10.2 控制模块被全部导入的内容"></a>10.2 控制模块被全部导入的内容</h3><p><strong>Q: 当使用’from module import *’语句时，希望对从模块或包导出的符号进行精确控制</strong></p>
<p>A: 在你的模块中定义一个<code>__all__</code>属性来列出你要导出的内容</p>
<h3 id="10-3-使用相对路径名导入包中子模块"><a href="#10-3-使用相对路径名导入包中子模块" class="headerlink" title="10.3 使用相对路径名导入包中子模块"></a>10.3 使用相对路径名导入包中子模块</h3><p><strong>Q: 将代码组织成包, 想用import 语句从另一个包名没有硬编码过的包的中导入子模块。</strong></p>
<p>A: <code>from . import  samepackge</code> ,其实<code>from</code>后面跟一个相对路径就好</p>
<h3 id="10-4-将模块分割成多个文件"><a href="#10-4-将模块分割成多个文件" class="headerlink" title="10.4 将模块分割成多个文件"></a>10.4 将模块分割成多个文件</h3><p><strong>Q: 你想将一个模块分割成多个文件。但是你不想将分离的文件统一成一个逻辑模块时使已有的代码遭到破坏。</strong></p>
<p>A: 在<code>__init__.py</code> 文件中统一导入就好，如果模块太多又不想导入，也可以定义成延迟导入(详情见本书示例)</p>
<h3 id="10-5-利用命名空间导入目录分散的代码"><a href="#10-5-利用命名空间导入目录分散的代码" class="headerlink" title="10.5 利用命名空间导入目录分散的代码"></a>10.5 利用命名空间导入目录分散的代码</h3><p><strong>Q: 你可能有大量的代码，由不同的人来分散地维护。每个部分被组织为文件目录，如一个包。然而，你希望能用共同的包前缀将所有组件连接起来，不是将每一个部分作为独立的包来安装。</strong></p>
<p>A: 用一个顶级的python包，包下面有不同的模块文件，删去用来将组件联合起来的<code>__init__.py</code> 文件</p>
<h3 id="10-6-重新加载模块"><a href="#10-6-重新加载模块" class="headerlink" title="10.6 重新加载模块"></a>10.6 重新加载模块</h3><p><strong>Q: 你想重新加载已经加载的模块，因为你对其源码进行了修改。</strong></p>
<p>A: 使用<code>imp.reload()</code></p>
<h3 id="10-7-运行目录或压缩文件"><a href="#10-7-运行目录或压缩文件" class="headerlink" title="10.7 运行目录或压缩文件"></a>10.7 运行目录或压缩文件</h3><p><strong>Q: 您有一个已成长为包含多个文件的应用，它已远不再是一个简单的脚本，你想向用户提供一些简单的方法运行这个程序</strong></p>
<p>A: 在目录里添加<code>__main__.py</code>文件就可以把目录当做一个运行程序来运行啦</p>
<h3 id="10-8-读取位于包中的数据文件"><a href="#10-8-读取位于包中的数据文件" class="headerlink" title="10.8 读取位于包中的数据文件"></a>10.8 读取位于包中的数据文件</h3><p><strong>Q: 你的包中包含代码需要去读取的数据文件。你需要尽可能地用最便捷的方式来做这件事</strong></p>
<p>A: 假设你的包中的文件组织成如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mypackage/</span><br><span class="line">    __init__.py</span><br><span class="line">    somedata.dat</span><br><span class="line">    spam.py</span><br></pre></td></tr></table></figure>
<p>现在假设<code>spam.py</code> 文件需要读取<code>somedata.dat</code> 文件中的内容。你可以用以下代码来完成：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># spam.py</span></span><br><span class="line"><span class="keyword">import</span> pkgutil</span><br><span class="line">data = pkgutil.get_data(__package__, <span class="string">'somedata.dat'</span>)</span><br></pre></td></tr></table></figure>
<h3 id="10-9-将文件夹加入到sys-path"><a href="#10-9-将文件夹加入到sys-path" class="headerlink" title="10.9 将文件夹加入到sys.path"></a>10.9 将文件夹加入到sys.path</h3><p><strong>Q: 你无法导入你的Python 代码因为它所在的目录不在sys.path 里。你想将添加新目录到Python 路径，但是不想硬链接到你的代码。</strong></p>
<p>A: 第一种方式是在你的环境变量<code>PYTHONPATH</code>添加路径，第二种就是创建一个<code>myapplication.pth</code>文件将路径写进去，放在<code>site-packages</code>目录下，还有就是在脚本开头导入路径<code>sys.path.insert(0, &#39;/some/dir&#39;)</code>，<code>sys.path.appedn(&#39;/some/dir&#39;)</code>，</p>
<h3 id="10-10-通过字符串名导入模块"><a href="#10-10-通过字符串名导入模块" class="headerlink" title="10.10 通过字符串名导入模块"></a>10.10 通过字符串名导入模块</h3><p><strong>Q: 你想导入一个模块，但是模块的名字在字符串里。你想对字符串调用导入命令。</strong></p>
<p>A: <code>importlib.import_module()</code>函数返回一个模块对象</p>
<h3 id="10-11-通过钩子远程加载模块-待补充"><a href="#10-11-通过钩子远程加载模块-待补充" class="headerlink" title="10.11 通过钩子远程加载模块(待补充)"></a>10.11 通过钩子远程加载模块(待补充)</h3><h3 id="10-12-导入模块的同时修改模块-待补充"><a href="#10-12-导入模块的同时修改模块-待补充" class="headerlink" title="10.12 导入模块的同时修改模块(待补充)"></a>10.12 导入模块的同时修改模块(待补充)</h3><h3 id="10-13-安装私有的包"><a href="#10-13-安装私有的包" class="headerlink" title="10.13 安装私有的包"></a>10.13 安装私有的包</h3><p><strong>Q: 你想要安装一个第三方包，但是没有权限将它安装到系统Python 库中去。或者，你可能想要安装一个供自己使用的包，而不是系统上面所有用户。</strong></p>
<p>A:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python3 setup.py install --user</span><br><span class="line">pip install --user packagename</span><br></pre></td></tr></table></figure></p>
<h3 id="10-14-创建新的Python-环境"><a href="#10-14-创建新的Python-环境" class="headerlink" title="10.14 创建新的Python 环境"></a>10.14 创建新的Python 环境</h3><p><strong>Q: 你想创建一个新的Python 环境，用来安装模块和包。不过，你不想安装一个新的Python 克隆，也不想对系统Python 环境产生影响。</strong></p>
<p>A: 用<code>pyvenv</code>创建一个虚拟环境，请参阅<a href="https://www.python.org/dev/peps/pep-0405/" target="_blank" rel="noopener">PEP405</a></p>
<h3 id="10-15-分发包-待补充"><a href="#10-15-分发包-待补充" class="headerlink" title="10.15 分发包(待补充)"></a>10.15 分发包(待补充)</h3><hr>
<hr>
<h2 id="第十一章：网络与Web-编程-待补充"><a href="#第十一章：网络与Web-编程-待补充" class="headerlink" title="第十一章：网络与Web 编程(待补充)"></a>第十一章：网络与Web 编程(待补充)</h2><h3 id="11-1-作为客户端与HTTP-服务交互"><a href="#11-1-作为客户端与HTTP-服务交互" class="headerlink" title="11.1 作为客户端与HTTP 服务交互"></a>11.1 作为客户端与HTTP 服务交互</h3><p><strong>Q: 你需要通过HTTP 协议以客户端的方式访问多种服务。例如，下载数据或者与基于REST 的API 进行交互</strong></p>
<p>A: 通常我们会有<code>urllib.request</code>, <code>requests</code> 两种方式来我完成，由于<code>requests</code>库比较简单，所以示例我们这个来写个简单的POST请求：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">'http://httpbin.org/post'</span></span><br><span class="line"><span class="comment"># Dictionary of query parameters (if any)</span></span><br><span class="line">parms = &#123;</span><br><span class="line">    <span class="string">'name1'</span> : <span class="string">'value1'</span>,</span><br><span class="line">    <span class="string">'name2'</span> : <span class="string">'value2'</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment"># Extra headers</span></span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">'User-agent'</span> : <span class="string">'none/ofyourbusiness'</span>,</span><br><span class="line">    <span class="string">'Spam'</span> : <span class="string">'Eggs'</span></span><br><span class="line">&#125;</span><br><span class="line">resp = requests.post(url, data=parms, headers=headers)</span><br><span class="line"><span class="comment"># Decoded text returned by the request</span></span><br><span class="line">text = resp.text</span><br></pre></td></tr></table></figure>
<hr>
<hr>
<h2 id="第十二章：并发编程-待补充"><a href="#第十二章：并发编程-待补充" class="headerlink" title="第十二章：并发编程(待补充)"></a>第十二章：并发编程(待补充)</h2><h3 id="12-1-启动与停止线程"><a href="#12-1-启动与停止线程" class="headerlink" title="12.1 启动与停止线程"></a>12.1 启动与停止线程</h3><p><strong>Q: 你要为需要并发执行的代码创建/销毁线程</strong></p>
<p>A: <code>threading</code>库的简单使用：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> threading <span class="keyword">import</span> Thread</span><br><span class="line">t = Thread(target=somemethod,args=(someargvs,))</span><br><span class="line">t.start()</span><br><span class="line">t.join()</span><br><span class="line">t.is_alive()</span><br></pre></td></tr></table></figure>
<h3 id="12-2-判断线程是否已经启动"><a href="#12-2-判断线程是否已经启动" class="headerlink" title="12.2 判断线程是否已经启动"></a>12.2 判断线程是否已经启动</h3><p><strong>Q: 你已经启动了一个线程，但是你想知道它是不是真的已经开始运行了。</strong></p>
<p>A: 使用<code>threading</code> 库中的<code>Event</code> 对象</p>
<h3 id="12-3-线程间通信"><a href="#12-3-线程间通信" class="headerlink" title="12.3 线程间通信"></a>12.3 线程间通信</h3><p><strong>Q: 你的程序中有多个线程，你需要在这些线程之间安全地交换信息或数据</strong></p>
<p>A: 基本思路就是搞个外部队列，然后各个线程进行get或者put数据</p>
<h3 id="12-4-给关键部分加锁"><a href="#12-4-给关键部分加锁" class="headerlink" title="12.4 给关键部分加锁"></a>12.4 给关键部分加锁</h3><p><strong>Q: 你需要对多线程程序中的临界区加锁以避免竞争条件。</strong></p>
<p>A: 注意一下<code>threading.RLock</code> 和 <code>threading.Lock</code> 的区别</p>
<h3 id="12-5-防止死锁的加锁机制"><a href="#12-5-防止死锁的加锁机制" class="headerlink" title="12.5 防止死锁的加锁机制"></a>12.5 防止死锁的加锁机制</h3><p><strong>Q: 你正在写一个多线程程序，其中线程需要一次获取多个锁，此时如何避免死锁问题。</strong></p>
<p>A: 给锁加ID</p>
<h3 id="12-6-保存线程的状态信息"><a href="#12-6-保存线程的状态信息" class="headerlink" title="12.6 保存线程的状态信息"></a>12.6 保存线程的状态信息</h3><p><strong>Q: 你需要保存正在运行线程的状态，这个状态对于其他的线程是不可见的。</strong></p>
<p>A: </p>
<hr>
<hr>
<h2 id="第十三章：脚本编程与系统管理"><a href="#第十三章：脚本编程与系统管理" class="headerlink" title="第十三章：脚本编程与系统管理"></a>第十三章：脚本编程与系统管理</h2><h3 id="13-1-通过重定向-管道-文件接受输入"><a href="#13-1-通过重定向-管道-文件接受输入" class="headerlink" title="13.1 通过重定向/管道/文件接受输入"></a>13.1 通过重定向/管道/文件接受输入</h3><p><strong>Q: 13.1 通过重定向/管道/文件接受输入</strong></p>
<p>A: <code>fileinput.input()</code>可以接收管道输入的文件列表</p>
<h3 id="13-2-终止程序并给出错误信息"><a href="#13-2-终止程序并给出错误信息" class="headerlink" title="13.2 终止程序并给出错误信息"></a>13.2 终止程序并给出错误信息</h3><p><strong>Q: 你想向标准错误打印一条消息并返回某个非零状态码来终止程序运行解</strong></p>
<p>A: 抛出一个<code>SystemExit</code> 异常:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">raise</span> SystemExit(<span class="string">'It failed!'</span>)</span><br><span class="line">或者</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">sys.stderr.write(<span class="string">'It failed!\n'</span>)</span><br><span class="line"><span class="keyword">raise</span> SystemExit(<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<h3 id="13-3-解析命令行选项"><a href="#13-3-解析命令行选项" class="headerlink" title="13.3 解析命令行选项"></a>13.3 解析命令行选项</h3><p><strong>Q: 你的程序如何能够解析命令行选项（位于sys.argv 中）</strong></p>
<p>A: <code>argparse</code> 模块</p>
<h3 id="13-4-运行时弹出密码输入提示"><a href="#13-4-运行时弹出密码输入提示" class="headerlink" title="13.4 运行时弹出密码输入提示"></a>13.4 运行时弹出密码输入提示</h3><p><strong>Q: 你写了个脚本，运行时需要一个密码。此脚本是交互式的，因此不能将密码在脚本中硬编码，而是需要弹出一个密码输入提示，让用户自己输入。</strong></p>
<p>A:　看代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> getpass</span><br><span class="line">user = getpass.getuser()</span><br><span class="line">passwd = getpass.getpass()</span><br></pre></td></tr></table></figure>
<p>代码中<code>getpass.getuser()</code> 不会弹出用户名的输入提示。它会根据该用户的shell 环境或者会依据本地系统的密码库（支持pwd 模块的平台）来使用当前用户的登录名，如果你想显示的弹出用户名输入提示，使用内置的input 函数：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">user = input(<span class="string">'Enter your username: '</span>)</span><br></pre></td></tr></table></figure></p>
<h3 id="13-5-获取终端的大小"><a href="#13-5-获取终端的大小" class="headerlink" title="13.5 获取终端的大小"></a>13.5 获取终端的大小</h3><p><strong>Q: 你需要知道当前终端的大小以便正确的格式化输出。</strong></p>
<p>A: <code>os.get_terminal_size()</code>函数</p>
<h3 id="13-6-执行外部命令并获取它的输出"><a href="#13-6-执行外部命令并获取它的输出" class="headerlink" title="13.6 执行外部命令并获取它的输出"></a>13.6 执行外部命令并获取它的输出</h3><p><strong>Q: 你想执行一个外部命令并以Python 字符串的形式获取执行结果。</strong></p>
<p>A: <code>subprocess</code>模块</p>
<h3 id="13-7-复制或者移动文件和目录"><a href="#13-7-复制或者移动文件和目录" class="headerlink" title="13.7 复制或者移动文件和目录"></a>13.7 复制或者移动文件和目录</h3><p><strong>Q: 你想要复制或移动文件和目录，但是又不想调用shell 命令。</strong></p>
<p>A: <code>shutil</code> 模块</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> shutil</span><br><span class="line"><span class="comment"># Copy src to dst. (cp src dst)</span></span><br><span class="line">shutil.copy(src, dst)</span><br><span class="line"><span class="comment"># Copy files, but preserve metadata (cp -p src dst)</span></span><br><span class="line">shutil.copy2(src, dst)</span><br><span class="line"><span class="comment"># Copy directory tree (cp -R src dst)</span></span><br><span class="line">shutil.copytree(src, dst)</span><br><span class="line"><span class="comment"># Move src to dst (mv src dst)</span></span><br><span class="line">shutil.move(src, dst)</span><br></pre></td></tr></table></figure>
<h3 id="13-8-创建和解压归档文件"><a href="#13-8-创建和解压归档文件" class="headerlink" title="13.8 创建和解压归档文件"></a>13.8 创建和解压归档文件</h3><p><strong>Q: 你需要创建或解压常见格式的归档文件（比如.tar, .tgz 或.zip）</strong></p>
<p>A: <code>shutil</code> 模块拥有两个函数——<code>make_archive()</code> 和<code>unpack_archive()</code> 可派上用场。例如：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> shutil</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>shutil.unpack_archive(<span class="string">'Python-3.3.0.tgz'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>shutil.make_archive(<span class="string">'py33'</span>,<span class="string">'zip'</span>,<span class="string">'Python-3.3.0'</span>)</span><br></pre></td></tr></table></figure></p>
<h3 id="13-9-通过文件名查找文件"><a href="#13-9-通过文件名查找文件" class="headerlink" title="13.9 通过文件名查找文件"></a>13.9 通过文件名查找文件</h3><p><strong>Q: 你需要写一个涉及到文件查找操作的脚本，比如对日志归档文件的重命名工具，你不想在Python 脚本中调用shell，或者你要实现一些shell 不能做的功能。</strong></p>
<p>A: 用<code>os.walk()</code> 函数, <code>os.walk()</code> 方法为我们遍历目录树，每次进入一个目录，它会返回一个三元组，包<br>含相对于查找目录的相对路径，一个该目录下的目录名列表，以及那个目录下面的文件名列表。</p>
<h3 id="13-10-读取配置文件"><a href="#13-10-读取配置文件" class="headerlink" title="13.10 读取配置文件"></a>13.10 读取配置文件</h3><p><strong>Q: 怎样读取普通.ini 格式的配置文件？</strong></p>
<p>A: <code>configparser</code> 模块</p>
<h3 id="13-11-给简单脚本增加日志功能"><a href="#13-11-给简单脚本增加日志功能" class="headerlink" title="13.11 给简单脚本增加日志功能"></a>13.11 给简单脚本增加日志功能</h3><p><strong>Q: 你希望在脚本和程序中将诊断信息写入日志文件。</strong></p>
<p>A: <code>logging</code> 模块</p>
<h3 id="13-12-给函数库增加日志功能"><a href="#13-12-给函数库增加日志功能" class="headerlink" title="13.12 给函数库增加日志功能"></a>13.12 给函数库增加日志功能</h3><p><strong>Q: 你想给某个函数库增加日志功能，但是又不能影响到那些不使用日志功能的程序。</strong></p>
<p>A: <code>getLogger(__name__)</code>是给当前模块添加日志，相应的把<code>__name__</code>换成其他模块就是给其他模块添加(修改)日志</p>
<h3 id="13-13-实现一个计时器-略"><a href="#13-13-实现一个计时器-略" class="headerlink" title="13.13 实现一个计时器(略)"></a>13.13 实现一个计时器(略)</h3><h3 id="13-14-限制内存和CPU-的使用量"><a href="#13-14-限制内存和CPU-的使用量" class="headerlink" title="13.14 限制内存和CPU 的使用量"></a>13.14 限制内存和CPU 的使用量</h3><p><strong>Q: 你想对在Unix 系统上面运行的程序设置内存或CPU 的使用限制。</strong></p>
<p>A: <code>resource</code> 模块</p>
<h3 id="13-15-启动一个WEB-浏览器"><a href="#13-15-启动一个WEB-浏览器" class="headerlink" title="13.15 启动一个WEB 浏览器"></a>13.15 启动一个WEB 浏览器</h3><p><strong>Q: 你想通过脚本启动浏览器并打开指定的URL 网页</strong></p>
<p>A: <code>webbrowser</code> 模块</p>
<hr>
<hr>
<h2 id="第十四章：测试、调试和异常-待补充"><a href="#第十四章：测试、调试和异常-待补充" class="headerlink" title="第十四章：测试、调试和异常(待补充)"></a>第十四章：测试、调试和异常(待补充)</h2><hr>
<hr>
<h2 id="第十五章：C-语言扩展-待补充"><a href="#第十五章：C-语言扩展-待补充" class="headerlink" title="第十五章：C 语言扩展(待补充)"></a>第十五章：C 语言扩展(待补充)</h2>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/12/10/爬虫系列(五)---获取可用代理/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Naruto">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/137356299.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="木叶村">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/12/10/爬虫系列(五)---获取可用代理/" itemprop="url">爬虫系列(五)---获取可用代理</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-12-10T00:00:00+08:00">
                2018-12-10
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/爬虫/" itemprop="url" rel="index">
                    <span itemprop="name">爬虫</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> requests </span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"><span class="keyword">from</span> requests.exceptions <span class="keyword">import</span> RequestException</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">parse_ip</span><span class="params">(http,ip,port)</span>:</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        proxies = &#123;<span class="string">"http"</span>: <span class="string">"http://"</span>+ip+<span class="string">":"</span>+port&#125;</span><br><span class="line">        print(proxies)</span><br><span class="line">        resp2 = requests.get(<span class="string">"http://2018.ip138.com/ic.asp"</span>, proxies=proxies)</span><br><span class="line">        soup = BeautifulSoup(resp2.content.decode(<span class="string">"gbk"</span>), <span class="string">"html.parser"</span>)</span><br><span class="line">        <span class="keyword">return</span> soup.body.get_text()</span><br><span class="line">    <span class="keyword">except</span> RequestException <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">None</span> </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_proxy</span><span class="params">(index)</span>:</span></span><br><span class="line">    headers = &#123;</span><br><span class="line">        <span class="string">"User-Agent"</span>: <span class="string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.110 Safari/537.36"</span></span><br><span class="line">    &#125;</span><br><span class="line">    html = requests.get(<span class="string">f"https://www.xicidaili.com/nn/<span class="subst">&#123;index&#125;</span>"</span>,headers=headers)</span><br><span class="line">    <span class="comment">#print(html.text)</span></span><br><span class="line">    soup = BeautifulSoup(html.content,<span class="string">"lxml"</span>)</span><br><span class="line">    get_info = soup.find_all(<span class="string">"tr"</span>)</span><br><span class="line">    <span class="comment">#print(get_info[1])</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> get_info:</span><br><span class="line">        get_ip = re.match(<span class="string">"&lt;tr.+?&gt;.&lt;td.+?&gt;&lt;/td&gt;.&lt;td&gt;(.+?)&lt;/td&gt;.&lt;td&gt;(.+?)&lt;/td&gt;.+(HTTP\w)"</span>,str(i),re.S)</span><br><span class="line">        <span class="comment"># &lt;tr.+?&gt;.&lt;td.+?&gt;&lt;/td&gt;.&lt;td&gt;(.+?)&lt;/td&gt;.&lt;td&gt;(.+?)&lt;/td&gt;.+(HTTP\w)</span></span><br><span class="line">        <span class="keyword">if</span> get_ip:</span><br><span class="line">            <span class="comment">#print(f"&#123;get_ip.group(3)&#125;://&#123;get_ip.group(1)&#125;:&#123;get_ip.group(2)&#125;")</span></span><br><span class="line">            ip = parse_ip(get_ip.group(<span class="number">3</span>),get_ip.group(<span class="number">1</span>),get_ip.group(<span class="number">2</span>))</span><br><span class="line">            <span class="comment">#print(ip)</span></span><br><span class="line">            time.sleep(<span class="number">10</span>)</span><br><span class="line">            <span class="keyword">if</span> ip:</span><br><span class="line">                <span class="keyword">return</span> ip</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">for</span> index <span class="keyword">in</span> range(<span class="number">10</span>):</span><br><span class="line">        print(get_proxy(index))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/12/05/爬虫系列(四)---保持登陆/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Naruto">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/137356299.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="木叶村">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/12/05/爬虫系列(四)---保持登陆/" itemprop="url">爬虫系列(四)---保持登陆</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-12-05T00:00:00+08:00">
                2018-12-05
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/爬虫/" itemprop="url" rel="index">
                    <span itemprop="name">爬虫</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>在爬取一些网站的时候，需要登陆，而且需要一直保持登陆状态才可以看一些文章，比如知乎、微博，这时我们就需要把我们的登陆信息在请求的时候一并提交，而这个登陆信息就是cookies</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests </span><br><span class="line"><span class="keyword">from</span>  urllib.request <span class="keyword">import</span> urlopen</span><br><span class="line"><span class="comment"># 可以保持同一个cookies，保持登陆状态</span></span><br><span class="line"><span class="comment">#s = s.Session()</span></span><br><span class="line"><span class="comment">#s = s.get("https://weibo.com") # 没有登陆的状态</span></span><br><span class="line"><span class="comment">#print(s.text)</span></span><br><span class="line"><span class="comment"># 不知道为什么用 requests 请求到的网页是中文乱码，而且不能用 bg2313 解码</span></span><br><span class="line"><span class="comment"># 但是用 uurllib 的就没事，这里暂时先不管了</span></span><br><span class="line"><span class="comment">#s = urlopen("https://weibo.com")</span></span><br><span class="line"><span class="comment">#print(s.read().decode("gb2312"))</span></span><br><span class="line"></span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">"Cookie"</span>: <span class="string">"太长了，这里就不写了"</span>,</span><br><span class="line">    <span class="string">"Host"</span>: <span class="string">"weibo.com"</span>,</span><br><span class="line">    <span class="string">"User-Agent"</span>: <span class="string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.110 Safari/537.36"</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">s = requests.Session()</span><br><span class="line">s = s.get(<span class="string">"这里的地址必须是跟你在Request URL看到的一样"</span>,headers=headers)</span><br><span class="line">print(s.text)</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/12/03/python3基础知识系列-函数装饰器/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Naruto">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/137356299.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="木叶村">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/12/03/python3基础知识系列-函数装饰器/" itemprop="url">python3基础知识系列--函数装饰器</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-12-03T00:00:00+08:00">
                2018-12-03
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/python3/" itemprop="url" rel="index">
                    <span itemprop="name">python3</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><strong>装饰器</strong>是一个函数，其主要用途是包装另一个函数或类。这种包装的首要目的是光明正大地修改或增强被包装对象的行为。语法上使用 特殊符号<code>@</code> 表示装饰器，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@trace</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">square</span><span class="params">(x)</span>:</span></span><br><span class="line">　　 <span class="keyword">return</span> x*x</span><br></pre></td></tr></table></figure>
<p>上面的代码是下面代码的简化：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">square</span><span class="params">(x)</span>:</span></span><br><span class="line">　　<span class="keyword">return</span> x*x</span><br><span class="line">square = trace(square)</span><br></pre></td></tr></table></figure>
<p>下面介绍几种用法：</p>
<p>在类定义中，所有函数都被假定在实例上操作，该实例总是作为第一个参数self 传递。但是，还可以定义两种常见的方法。</p>
<p><strong>静态方法</strong> 是一种普通函数，只不过它们正好位于类定义的命名空间中。它不会对任何实例类型进行操作。要定义静态方<br>法，可使用<code>@staticmethod</code> 装饰器，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Foo</span><span class="params">(object)</span>:</span></span><br><span class="line">　　 @staticmethod</span><br><span class="line">　　 <span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(x,y)</span>:</span></span><br><span class="line">　　　　 <span class="keyword">return</span> x + y</span><br></pre></td></tr></table></figure>
<p>要调用静态方法，只需用类名作为它的前缀。无需向它传递任何其他信息，例如：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">x = Foo.add(<span class="number">3</span>,<span class="number">4</span>)　　 <span class="comment"># x = 7</span></span><br></pre></td></tr></table></figure>
<p>如果在编写类时需要采用很多不同的方式来创建新实例，则常常使用静态方法。因为类中只能有一个<code>__init__()</code> 函数，所以替代的创建函数通常按如下方式定义：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Date</span><span class="params">(object)</span>:</span></span><br><span class="line">　　<span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,year,month,day)</span>:</span></span><br><span class="line">　　　　self.year = year</span><br><span class="line">　　　　self.month = month</span><br><span class="line">　　　　self.day = day</span><br><span class="line">　　@staticmethod</span><br><span class="line">　　<span class="function"><span class="keyword">def</span> <span class="title">now</span><span class="params">()</span>:</span></span><br><span class="line">　　　　 t = time.localtime()</span><br><span class="line">　　　　 <span class="keyword">return</span> Date(t.tm_year, t.tm_mon, t.tm_day)</span><br><span class="line">　　@staticmethod</span><br><span class="line">　　<span class="function"><span class="keyword">def</span> <span class="title">tomorrow</span><span class="params">()</span>:</span></span><br><span class="line">　　　　 t = time.localtime(time.time()+<span class="number">86400</span>)</span><br><span class="line">　　　　 <span class="keyword">return</span> Date(t.tm_year, t.tm_mon, t.tm_day)</span><br><span class="line"><span class="comment"># 创建日期的示例</span></span><br><span class="line">a = Date(<span class="number">1967</span>, <span class="number">4</span>, <span class="number">9</span>)</span><br><span class="line">b = Date.now()　　　　 <span class="comment"># 调用静态方法now()</span></span><br><span class="line">c = Date.tomorrow()　　<span class="comment"># 调用静态方法tomorrow()</span></span><br></pre></td></tr></table></figure>
<p><strong>类方法</strong> 是将类本身作为对象进行操作的方法。类方法使用<code>@classmethod</code> 装饰器定义，与实例方法不同，因为根据约定，类是作为第一个参数（名为cls ）传递的，例如：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Times</span><span class="params">(object)</span>:</span></span><br><span class="line">　　factor = <span class="number">1</span></span><br><span class="line">　　@classmethod</span><br><span class="line">　　<span class="function"><span class="keyword">def</span> <span class="title">mul</span><span class="params">(cls,x)</span>:</span></span><br><span class="line">　　　　<span class="keyword">return</span> cls.factor*x</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TwoTimes</span><span class="params">(Times)</span>:</span></span><br><span class="line">　　factor = <span class="number">2</span></span><br><span class="line">x = TwoTimes.mul(<span class="number">4</span>)　　<span class="comment"># 调用Times.mul(TwoTimes, 4) -&gt; 8</span></span><br></pre></td></tr></table></figure>
<p>最后介绍一个装饰器函数是<code>@property</code>, 是将对象的方法变为属性的一个装饰器，这个在<strong>python3cookbook</strong>系列中讲过了，这里就不举例了</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/12/02/机器学习实战笔记(五)--决策树(二)/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Naruto">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/137356299.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="木叶村">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/12/02/机器学习实战笔记(五)--决策树(二)/" itemprop="url">机器学习实战笔记(五)---决策树(二)</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-12-02T00:00:00+08:00">
                2018-12-02
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/机器学习/" itemprop="url" rel="index">
                    <span itemprop="name">机器学习</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># @Time    : 2018/1/3 14:02</span></span><br><span class="line"><span class="comment"># @Author  : wangzy</span></span><br><span class="line"><span class="comment"># 原文代码作者：https://github.com/wzyonggege/statistical-learning-method</span></span><br><span class="line"><span class="comment"># </span></span><br><span class="line"><span class="comment"># 中文注释制作：机器学习初学者(微信公众号：ID:ai-start-com)</span></span><br><span class="line"><span class="comment"># </span></span><br><span class="line"><span class="comment"># 配置环境：python 3.6</span></span><br><span class="line"><span class="comment"># </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> log</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义节点类 二叉树</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Node</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, root=True, label=None, feature_name=None, feature=None)</span>:</span></span><br><span class="line">        self.root = root</span><br><span class="line">        self.label = label</span><br><span class="line">        self.feature_name = feature_name</span><br><span class="line">        self.feature = feature</span><br><span class="line">        self.tree = &#123;&#125;</span><br><span class="line">        self.result = &#123;<span class="string">'label:'</span>: self.label, <span class="string">'feature'</span>: self.feature, <span class="string">'tree'</span>: self.tree&#125;</span><br><span class="line">    <span class="comment"># 调用 __repr__ 而不是 __str__</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__repr__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">'&#123;&#125;'</span>.format(self.result)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">add_node</span><span class="params">(self, val, node)</span>:</span></span><br><span class="line">        self.tree[val] = node</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">predict</span><span class="params">(self, features)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> self.root <span class="keyword">is</span> <span class="keyword">True</span>:</span><br><span class="line">            <span class="keyword">return</span> self.label</span><br><span class="line">        <span class="keyword">return</span> self.tree[features[self.feature]].predict(features)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 书上题目5.1</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">create_data</span><span class="params">()</span>:</span></span><br><span class="line">    datasets = [[<span class="string">'青年'</span>, <span class="string">'否'</span>, <span class="string">'否'</span>, <span class="string">'一般'</span>, <span class="string">'否'</span>],</span><br><span class="line">               [<span class="string">'青年'</span>, <span class="string">'否'</span>, <span class="string">'否'</span>, <span class="string">'好'</span>, <span class="string">'否'</span>],</span><br><span class="line">               [<span class="string">'青年'</span>, <span class="string">'是'</span>, <span class="string">'否'</span>, <span class="string">'好'</span>, <span class="string">'是'</span>],</span><br><span class="line">               [<span class="string">'青年'</span>, <span class="string">'是'</span>, <span class="string">'是'</span>, <span class="string">'一般'</span>, <span class="string">'是'</span>],</span><br><span class="line">               [<span class="string">'青年'</span>, <span class="string">'否'</span>, <span class="string">'否'</span>, <span class="string">'一般'</span>, <span class="string">'否'</span>],</span><br><span class="line">               [<span class="string">'中年'</span>, <span class="string">'否'</span>, <span class="string">'否'</span>, <span class="string">'一般'</span>, <span class="string">'否'</span>],</span><br><span class="line">               [<span class="string">'中年'</span>, <span class="string">'否'</span>, <span class="string">'否'</span>, <span class="string">'好'</span>, <span class="string">'否'</span>],</span><br><span class="line">               [<span class="string">'中年'</span>, <span class="string">'是'</span>, <span class="string">'是'</span>, <span class="string">'好'</span>, <span class="string">'是'</span>],</span><br><span class="line">               [<span class="string">'中年'</span>, <span class="string">'否'</span>, <span class="string">'是'</span>, <span class="string">'非常好'</span>, <span class="string">'是'</span>],</span><br><span class="line">               [<span class="string">'中年'</span>, <span class="string">'否'</span>, <span class="string">'是'</span>, <span class="string">'非常好'</span>, <span class="string">'是'</span>],</span><br><span class="line">               [<span class="string">'老年'</span>, <span class="string">'否'</span>, <span class="string">'是'</span>, <span class="string">'非常好'</span>, <span class="string">'是'</span>],</span><br><span class="line">               [<span class="string">'老年'</span>, <span class="string">'否'</span>, <span class="string">'是'</span>, <span class="string">'好'</span>, <span class="string">'是'</span>],</span><br><span class="line">               [<span class="string">'老年'</span>, <span class="string">'是'</span>, <span class="string">'否'</span>, <span class="string">'好'</span>, <span class="string">'是'</span>],</span><br><span class="line">               [<span class="string">'老年'</span>, <span class="string">'是'</span>, <span class="string">'否'</span>, <span class="string">'非常好'</span>, <span class="string">'是'</span>],</span><br><span class="line">               [<span class="string">'老年'</span>, <span class="string">'否'</span>, <span class="string">'否'</span>, <span class="string">'一般'</span>, <span class="string">'否'</span>],</span><br><span class="line">               ]</span><br><span class="line">    <span class="comment"># 每行的名字</span></span><br><span class="line">    labels = [<span class="string">u'年龄'</span>, <span class="string">u'有工作'</span>, <span class="string">u'有自己的房子'</span>, <span class="string">u'信贷情况'</span>, <span class="string">u'类别'</span>]</span><br><span class="line">    <span class="comment"># 返回数据集和每个维度的名称</span></span><br><span class="line">    <span class="keyword">return</span> datasets, labels</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DTree</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, epsilon=<span class="number">0.1</span>)</span>:</span></span><br><span class="line">        self.epsilon = epsilon</span><br><span class="line">        self._tree = &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 熵</span></span><br><span class="line"><span class="meta">    @staticmethod # 声明的静态方法，因此无需实例化，不用写self，可以直接使用</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">calc_ent</span><span class="params">(datasets)</span>:</span></span><br><span class="line">        data_length = len(datasets)</span><br><span class="line">        label_count = &#123;&#125;</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(data_length):</span><br><span class="line">            label = datasets[i][<span class="number">-1</span>]</span><br><span class="line">            <span class="keyword">if</span> label <span class="keyword">not</span> <span class="keyword">in</span> label_count:</span><br><span class="line">                label_count[label] = <span class="number">0</span></span><br><span class="line">            label_count[label] += <span class="number">1</span></span><br><span class="line">        ent = -sum([(p/data_length)*log(p/data_length, <span class="number">2</span>) <span class="keyword">for</span> p <span class="keyword">in</span> label_count.values()])</span><br><span class="line">        <span class="keyword">return</span> ent</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 经验条件熵</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">cond_ent</span><span class="params">(self, datasets, axis=<span class="number">0</span>)</span>:</span></span><br><span class="line">        data_length = len(datasets)</span><br><span class="line">        feature_sets = &#123;&#125;</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(data_length):</span><br><span class="line">            feature = datasets[i][axis]</span><br><span class="line">            <span class="keyword">if</span> feature <span class="keyword">not</span> <span class="keyword">in</span> feature_sets:</span><br><span class="line">                feature_sets[feature] = []</span><br><span class="line">            feature_sets[feature].append(datasets[i])</span><br><span class="line">        cond_ent = sum([(len(p)/data_length)*self.calc_ent(p) <span class="keyword">for</span> p <span class="keyword">in</span> feature_sets.values()])</span><br><span class="line">        <span class="keyword">return</span> cond_ent</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 信息增益</span></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">info_gain</span><span class="params">(ent, cond_ent)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> ent - cond_ent</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">info_gain_train</span><span class="params">(self, datasets)</span>:</span></span><br><span class="line">        count = len(datasets[<span class="number">0</span>]) - <span class="number">1</span></span><br><span class="line">        ent = self.calc_ent(datasets) <span class="comment"># 获得信息熵</span></span><br><span class="line">        best_feature = []</span><br><span class="line">        <span class="keyword">for</span> c <span class="keyword">in</span> range(count):</span><br><span class="line">            c_info_gain = self.info_gain(ent, self.cond_ent(datasets, axis=c)) <span class="comment"># 计算信息增益</span></span><br><span class="line">            best_feature.append((c, c_info_gain)) <span class="comment"># 存于列表中，然后选出信息增益最大的</span></span><br><span class="line">        <span class="comment"># 比较大小</span></span><br><span class="line">        best_ = max(best_feature, key=<span class="keyword">lambda</span> x: x[<span class="number">-1</span>])</span><br><span class="line">        <span class="keyword">return</span> best_</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">train</span><span class="params">(self, train_data)</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        input:数据集D(DataFrame格式)，特征集A，阈值eta</span></span><br><span class="line"><span class="string">        output:决策树T</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        1. 计算信息熵 H(D)</span></span><br><span class="line"><span class="string">        2. 获取信息增益最大的类别</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        <span class="comment"># 训练集，类别(y值),列名</span></span><br><span class="line">        _, y_train, features = train_data.iloc[:, :<span class="number">-1</span>], train_data.iloc[:, <span class="number">-1</span>], train_data.columns[:<span class="number">-1</span>]</span><br><span class="line">        <span class="comment"># 1,若D中实例属于同一类Ck，则T为单节点树，并将类Ck作为结点的类标记，返回T</span></span><br><span class="line">        <span class="keyword">if</span> len(y_train.value_counts()) == <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> Node(root=<span class="keyword">True</span>,</span><br><span class="line">                        label=y_train.iloc[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 2, 若A为空，则T为单节点树，将D中实例树最大的类Ck作为该节点的类标记，返回T</span></span><br><span class="line">        <span class="keyword">if</span> len(features) == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> Node(root=<span class="keyword">True</span>, label=y_train.value_counts().sort_values(ascending=<span class="keyword">False</span>).index[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 3,计算最大信息增益 同5.1,Ag为信息增益最大的特征</span></span><br><span class="line">        max_feature, max_info_gain = self.info_gain_train(np.array(train_data))</span><br><span class="line">        max_feature_name = features[max_feature]</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 4,Ag的信息增益小于阈值eta,则置T为单节点树，并将D中是实例数最大的类Ck作为该节点的类标记，返回T</span></span><br><span class="line">        <span class="keyword">if</span> max_info_gain &lt; self.epsilon:</span><br><span class="line">            <span class="keyword">return</span> Node(root=<span class="keyword">True</span>, label=y_train.value_counts().sort_values(ascending=<span class="keyword">False</span>).index[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 5,构建Ag子集</span></span><br><span class="line">        node_tree = Node(root=<span class="keyword">False</span>, feature_name=max_feature_name, feature=max_feature)</span><br><span class="line"></span><br><span class="line">        feature_list = train_data[max_feature_name].value_counts().index</span><br><span class="line">        <span class="keyword">for</span> f <span class="keyword">in</span> feature_list:</span><br><span class="line">            sub_train_df = train_data.loc[train_data[max_feature_name] == f].drop([max_feature_name], axis=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 6, 递归生成树</span></span><br><span class="line">            sub_tree = self.train(sub_train_df)</span><br><span class="line">            node_tree.add_node(f, sub_tree)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># pprint.pprint(node_tree.tree)</span></span><br><span class="line">        <span class="keyword">return</span> node_tree</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">fit</span><span class="params">(self, train_data)</span>:</span></span><br><span class="line">        self._tree = self.train(train_data)</span><br><span class="line">        <span class="keyword">return</span> self._tree</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">predict</span><span class="params">(self, X_test)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self._tree.predict(X_test)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    <span class="comment"># 数据是统计学与方法中的立体</span></span><br><span class="line">    datasets, labels = create_data()</span><br><span class="line">    data_df = pd.DataFrame(datasets, columns=labels)</span><br><span class="line">    <span class="comment">#print(data_df)</span></span><br><span class="line">    dt = DTree()</span><br><span class="line">    tree = dt.fit(data_df)</span><br><span class="line">    print(dt.predict([<span class="string">'老年'</span>, <span class="string">'否'</span>, <span class="string">'否'</span>, <span class="string">'一般'</span>]))</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/12/01/python3基础知识系列-匿名函数/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Naruto">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/137356299.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="木叶村">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/12/01/python3基础知识系列-匿名函数/" itemprop="url">python3基础知识系列--匿名函数</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-12-01T00:00:00+08:00">
                2018-12-01
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/python3/" itemprop="url" rel="index">
                    <span itemprop="name">python3</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>匿名函数其实就是lambda函数，不需要显示定义函数：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">f = <span class="keyword">lambda</span> x: x*x</span><br><span class="line">f(<span class="number">6</span>)</span><br><span class="line"><span class="comment"># 36</span></span><br></pre></td></tr></table></figure>
<p>这个等价于：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">(x)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> x*x</span><br></pre></td></tr></table></figure>
<p>但是匿名函数有一个限制就是只能写一个表达式</p>
<p>此外，<code>lambda</code>函数还可以与<code>map</code>, <code>sorted</code>等函数配合使用，我们以后再整理</p>
<p>list(map(lambda x: x * x, [1, 2, 3, 4, 5, 6, 7, 8, 9]))</p>
<h1 id="1-4-9-16-25-36-49-64-81"><a href="#1-4-9-16-25-36-49-64-81" class="headerlink" title="[1, 4, 9, 16, 25, 36, 49, 64, 81]"></a>[1, 4, 9, 16, 25, 36, 49, 64, 81]</h1>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/11/30/python3标准库系列(六)-base64/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Naruto">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/137356299.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="木叶村">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/11/30/python3标准库系列(六)-base64/" itemprop="url">python3 标准库系列(六)---base64</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-11-30T00:00:00+08:00">
                2018-11-30
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/python3/" itemprop="url" rel="index">
                    <span itemprop="name">python3</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Base64是一种用64个字符来表示任意二进制数据的方法。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 将二进制转为64位 存储</span></span><br><span class="line">base64.b64encode(<span class="string">b'hello world'</span>)</span><br></pre></td></tr></table></figure>
<pre><code>b&#39;aGVsbG8gd29ybGQ=&#39;
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">base64.b64decode(<span class="string">b'aGVsbG8gd29ybGQ='</span>) <span class="comment"># 解码</span></span><br></pre></td></tr></table></figure>
<pre><code>b&#39;hello world&#39;
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">base64.b64decode(<span class="string">b'aGVsbG8gd29ybGQ='</span>).decode(<span class="string">"utf-8"</span>)</span><br></pre></td></tr></table></figure>
<pre><code>&#39;hello world&#39;
</code></pre>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/6/">6</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/137356299.jpg"
               alt="Naruto" />
          <p class="site-author-name" itemprop="name">Naruto</p>
           
              <p class="site-description motion-element" itemprop="description"></p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">56</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">11</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">24</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="zhmqsnq90@foxmail.com" target="_blank" title="E-Mail">
                  
                    
                      E-Mail
                    
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Naruto</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.2"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.2"></script>



  
  

  
    <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.2"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.2"></script>

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.2"></script>



  


  




	





  





  






  





  

  

  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


  

  

</body>
</html>
